<div class="content">
    <div class="container">
        <link rel="stylesheet" href="https://app.4clinics.software/skin/home/app_theme/css/datatables/dataTables.bootstrap.css">
        <script type="text/javascript" src="https://app.4clinics.software/skin/home/app_theme/js/jquery.js"></script>
        <script type="text/javascript" src="https://app.4clinics.software/skin/home/app_theme/js/tinymce/tinymce.min.js"></script>
        <script src="https://app.4clinics.software/skin/home/app_theme/js/select2/select2.min.js"></script>
        <script src="https://app.4clinics.software/skin/home/app_theme/js/jquery.maskMoney.min.js"></script>
        <script type="text/javascript" src="https://app.4clinics.software/skin/home/app_theme/js/jquery.maskedinput.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.maskedinput/1.4.1/jquery.maskedinput.min.js"></script>
        <script src="https://raw.githubusercontent.com/igorescobar/jQuery-Mask-Plugin/master/src/jquery.mask.js"></script>

        <style type="text/css">
            .cursor-pointer{cursor: pointer;}
            button.btn{margin-right: 5px;}
            button.table-button{width: 100%;margin-top: 5px;}
            .cor{padding: .5em;margin: .1em .5em 0em .1em;width: .5em;float: left;}
            .color_brown{background-color: #444;}
            .color_lightblue{background-color: #5884a0;}
            .color_lightcyan{background-color: #bacdcd;font-weight:400;color:#000;margin: 1px 10px 0px 0px;padding:1px 3px;width:16px;}
            .color_red{background-color: #ff2222;}
            .color_green{background-color: #008000;}
            .color_blue{background-color: #0000ff;}
            .color_faturado{background-color: #2196f3;}
            .btn-primary{color: #fff;background-color: #337ab7;border-color: #2e6da4;}
            .btn-primary:hover{color: #fff;background-color: #337ab7;border-color: #2e6da4;}
            .consulta{background-color: #999;padding: 1px 3px;text-align: center;color: #fff;margin: 0px 10px 0px 0px;}
            .confirmado{background-color: #999;padding: 1px 3px;text-align: center;color: #fff;}
            .amarelo{color: #5884a0;font-weight:400;}
            .vermelho{color: #ff2222;font-weight:400;}
            .laranjado{background-color: #bacdcd;font-weight:400;color:#000;padding:6px;}
            .verde{color: #008000;font-weight:400;}
            .azul{color: #0000ff;font-weight:400;}
            .texto_faturado{color: #2196f3;font-weight:400;}
            #errorHF{float: right;margin: -14px 60px 5px 0px;}
            #errorHI{float: left;margin: -14px 60px 5px 0px;}
            #table-hours tbody tr{cursor: pointer;}
            .ui-datepicker .ui-datepicker-title .ui-datepicker-month {
            font-size: 12px;
            color: #999;
            font-weight: bold;
            }
        </style>
        <!-- MODAL TINYMCE 2 INICIO -->
        <button id="btnModalPrinter" style="display: none;" type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModalPrinter">Open Modal</button>
        <!-- Modal -->    
        <div class="modal fade" id="myModalPrinter" role="dialog" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header bg-darkblue">
                        <button type="button" class="close" data-dismiss="modal">×</button>
                        <h4 class="modal-title modal-title-darkblue">Imprimir:</h4>
                    </div>
                    <div class="modal-body">
                        <textarea name="textImpressao" id="textImpressao" cols="30" rows="10"></textarea>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-default pull-left" data-dismiss="modal" onclick="recarregar()">Fechar</button>
                        <button class="btn btn-primary pull-right" onclick="$('.mce-widget').each(function(){(($(this).attr('aria-label') == 'Print')? $(this).trigger('click') : '')}); return false;">Imprimir</button>                   
                        <button class="btn btn-primary pull-right" onclick="imprimirMPDF(); return false;">Imprimir PDF</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- MODAL TINYMCE 2 FIM -->
        <div class="portlet portlet-default">
            <div class="portlet-body">
                <table class="table table-striped table-bordered table-hover">
                    <thead>
                        <tr style="background-color:#87a3bc;">
                            <th>
                                <div class="col-md-7 col-xs-6">
                                    <h4 class="text_title calendario_text" style="margin-top:10px;margin-left:0px;color:#fff;font-size:20px">
                                        <i class="fa fa-calendar fa_rev" style="margin-bottom:5px;"></i> Consultas: 
                                        <spam style="font-weight:400;">JONH SNOW 0874.957.987-89</spam>
                                    </h4>
                                </div>
                                <div class="col-md-5 col-xs-6">
                                    <button type="button" class="btn btn-default pull-right btn-xs calendario_btn" style="margin-top:5px;" id="prox_dia" onclick="dia_posterior()">Próximo Dia <i class="fa fa-chevron-right"></i></button>   
                                    <button type="button" class="btn btn-default pull-right btn-xs calendario_btn" style="margin-top:5px;" id="hoje" onclick="dia_hoje()">Ver Hoje <i class="fa fa-calendar"></i></button>
                                    <button type="button" class="btn btn-default pull-right btn-xs calendario_btn" style="margin-top:5px;" id="dia_ant" onclick="dia_anterior()"><i class="fa fa-chevron-left"></i> Dia Anterior</button>
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <div class="col-md-4">
                                    <div id="datepicker" class="hasDatepicker">
                                        <div class="ui-datepicker-inline ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" style="display: block;">
                                            <div class="ui-datepicker-header ui-widget-header ui-helper-clearfix ui-corner-all">
                                                <a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="Prev"><span class="ui-icon ui-icon-circle-triangle-w">Prev</span></a><a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="Next"><span class="ui-icon ui-icon-circle-triangle-e">Next</span></a>
                                                <div class="ui-datepicker-title">
                                                    <select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">
                                                        <option value="0">Jan</option>
                                                        <option value="1">Fev</option>
                                                        <option value="2">Mar</option>
                                                        <option value="3">Abr</option>
                                                        <option value="4">Mai</option>
                                                        <option value="5">Jun</option>
                                                        <option value="6" selected="selected">Jul</option>
                                                        <option value="7">Ago</option>
                                                        <option value="8">Set</option>
                                                        <option value="9">Out</option>
                                                        <option value="10">Nov</option>
                                                        <option value="11">Dez</option>
                                                    </select>
                                                    <select class="ui-datepicker-year" data-handler="selectYear" data-event="change">
                                                        <option value="2006">2006</option>
                                                        <option value="2007">2007</option>
                                                        <option value="2008">2008</option>
                                                        <option value="2009">2009</option>
                                                        <option value="2010">2010</option>
                                                        <option value="2011">2011</option>
                                                        <option value="2012">2012</option>
                                                        <option value="2013">2013</option>
                                                        <option value="2014">2014</option>
                                                        <option value="2015">2015</option>
                                                        <option value="2016" selected="selected">2016</option>
                                                        <option value="2017">2017</option>
                                                        <option value="2018">2018</option>
                                                        <option value="2019">2019</option>
                                                        <option value="2020">2020</option>
                                                        <option value="2021">2021</option>
                                                        <option value="2022">2022</option>
                                                        <option value="2023">2023</option>
                                                        <option value="2024">2024</option>
                                                        <option value="2025">2025</option>
                                                        <option value="2026">2026</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <table class="ui-datepicker-calendar">
                                                <thead>
                                                    <tr>
                                                        <th scope="col" class="ui-datepicker-week-end"><span title="Domingo">D</span></th>
                                                        <th scope="col"><span title="Segunda">S</span></th>
                                                        <th scope="col"><span title="Terça">T</span></th>
                                                        <th scope="col"><span title="Quarta">Q</span></th>
                                                        <th scope="col"><span title="Quinta">Q</span></th>
                                                        <th scope="col"><span title="Sexta">S</span></th>
                                                        <th scope="col" class="ui-datepicker-week-end"><span title="Sábado">S</span></th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td class=" ui-datepicker-week-end ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td>
                                                        <td class=" ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td>
                                                        <td class=" ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td>
                                                        <td class=" ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td>
                                                        <td class=" ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">1</a></td>
                                                        <td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">2</a></td>
                                                    </tr>
                                                    <tr>
                                                        <td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">3</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">4</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">5</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">6</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">7</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">8</a></td>
                                                        <td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">9</a></td>
                                                    </tr>
                                                    <tr>
                                                        <td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">10</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">11</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">12</a></td>
                                                        <td class=" ui-datepicker-days-cell-over  ui-datepicker-current-day ui-datepicker-today" data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default ui-state-highlight ui-state-active" href="#">13</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">14</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">15</a></td>
                                                        <td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">16</a></td>
                                                    </tr>
                                                    <tr>
                                                        <td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">17</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">18</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">19</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">20</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">21</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">22</a></td>
                                                        <td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">23</a></td>
                                                    </tr>
                                                    <tr>
                                                        <td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">24</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">25</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">26</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">27</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">28</a></td>
                                                        <td class=" " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">29</a></td>
                                                        <td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">30</a></td>
                                                    </tr>
                                                    <tr>
                                                        <td class=" ui-datepicker-week-end " data-handler="selectDay" data-event="click" data-month="6" data-year="2016"><a class="ui-state-default" href="#">31</a></td>
                                                        <td class=" ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td>
                                                        <td class=" ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td>
                                                        <td class=" ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td>
                                                        <td class=" ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td>
                                                        <td class=" ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td>
                                                        <td class=" ui-datepicker-week-end ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <div class="ui-datepicker-buttonpane ui-widget-content"><button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">Hoje</button></div>
                                        </div>
                                    </div>
                                    <br>
                                    <div id="recursos">
                                        <h4> Recursos </h4>
                                        <table style="width:240px">
                                            <tbody>
                                                <tr>
                                                    <th><button type="button" class="btn btn-default btn-xs table-button recursos_btn" onclick="primeiro_horario()"><i class="fa fa-search"></i> Ver primeiro horário disponível</button></th>
                                                </tr>
                                                <tr>
                                                    <th><button type="button" class="btn btn-default btn-xs table-button recursos_btn" data-toggle="modal" data-target="#myModalEncaixe" id="inserir_encaixe"><i class="fa fa-magic"></i> Inserir encaixe</button></th>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <br>
                                    <div id="legenda">
                                        <h4> Legenda </h4>
                                        <table style="width:100%">
                                            <tbody>
                                                <tr>
                                                    <td>
                                                        <div class="cor color_brown"></div>
                                                        Agendamento
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <div class="cor color_lightblue"></div>
                                                        Encaixe
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <div class="cor color_red"></div>
                                                        Paciente na Recepção
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <div class="cor color_green"></div>
                                                        Atendido
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <div class="cor color_blue"></div>
                                                        Atendido com Guia Preenchida
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <div class="cor color_faturado"></div>
                                                        Atendido com Faturamento
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td><span class="consulta">P</span>Primeira Consulta</td>
                                                </tr>
                                                <tr>
                                                    <td><span class="consulta">C</span>Agendamento Confirmado</td>
                                                </tr>
                                                <tr>
                                                    <td><span class="cor color_lightcyan">F</span>Paciente Faltou<br><br></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="col-md-8">
                                    <div id="marca_consulta">
                                        <div id="data_selecionada" class="row calendario_bg centralizado">Quarta, 13/07/2016</div>
                                        <div class="row">
                                            <table class="table table-striped table-hover" id="table-hours">
                                                <thead>
                                                    <tr>
                                                        <td width="10%">
                                                            <div id="horas">Horas</div>
                                                        </td>
                                                        <td width="65%">
                                                            <div id="paciente">Paciente</div>
                                                        </td>
                                                        <td width="10%"></td>
                                                        <td width="15%">
                                                            <div id="status">Status</div>
                                                        </td>
                                                    </tr>
                                                </thead>
                                                <tbody id="tbody-table-hours">
                                                    <tr id="1000" class="10:00" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:00</td>
                                                        <td><span id="nome_paciente0"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1010" class="10:10" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:10</td>
                                                        <td><span id="nome_paciente10"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1011" class="10:11" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:11</td>
                                                        <td><span id="nome_paciente11"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1012" class="10:12" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:12</td>
                                                        <td><span id="nome_paciente12"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1013" class="10:13" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:13</td>
                                                        <td><span id="nome_paciente13"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1014" class="10:14" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:14</td>
                                                        <td><span id="nome_paciente14"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1015" class="10:15" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:15</td>
                                                        <td><span id="nome_paciente15"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1016" class="10:16" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:16</td>
                                                        <td><span id="nome_paciente16"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1017" class="10:17" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:17</td>
                                                        <td><span id="nome_paciente17"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1018" class="10:18" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:18</td>
                                                        <td><span id="nome_paciente18"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1019" class="10:19" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:19</td>
                                                        <td><span id="nome_paciente19"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1020" class="10:20" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:20</td>
                                                        <td><span id="nome_paciente20"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1021" class="10:21" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:21</td>
                                                        <td><span id="nome_paciente21"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1022" class="10:22" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:22</td>
                                                        <td><span id="nome_paciente22"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1023" class="10:23" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:23</td>
                                                        <td><span id="nome_paciente23"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1024" class="10:24" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:24</td>
                                                        <td><span id="nome_paciente24"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1025" class="10:25" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:25</td>
                                                        <td><span id="nome_paciente25"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1026" class="10:26" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:26</td>
                                                        <td><span id="nome_paciente26"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1027" class="10:27" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:27</td>
                                                        <td><span id="nome_paciente27"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1028" class="10:28" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:28</td>
                                                        <td><span id="nome_paciente28"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1029" class="10:29" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:29</td>
                                                        <td><span id="nome_paciente29"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1030" class="10:30" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:30</td>
                                                        <td><span id="nome_paciente30"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1031" class="10:31" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:31</td>
                                                        <td><span id="nome_paciente31"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1032" class="10:32" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:32</td>
                                                        <td><span id="nome_paciente32"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1033" class="10:33" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:33</td>
                                                        <td><span id="nome_paciente33"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1034" class="10:34" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:34</td>
                                                        <td><span id="nome_paciente34"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1035" class="10:35" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:35</td>
                                                        <td><span id="nome_paciente35"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1036" class="10:36" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:36</td>
                                                        <td><span id="nome_paciente36"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1037" class="10:37" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:37</td>
                                                        <td><span id="nome_paciente37"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1038" class="10:38" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:38</td>
                                                        <td><span id="nome_paciente38"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1039" class="10:39" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:39</td>
                                                        <td><span id="nome_paciente39"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1040" class="10:40" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:40</td>
                                                        <td><span id="nome_paciente40"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1041" class="10:41" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:41</td>
                                                        <td><span id="nome_paciente41"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1042" class="10:42" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:42</td>
                                                        <td><span id="nome_paciente42"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1043" class="10:43" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:43</td>
                                                        <td><span id="nome_paciente43"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1044" class="10:44" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:44</td>
                                                        <td><span id="nome_paciente44"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1045" class="10:45" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:45</td>
                                                        <td><span id="nome_paciente45"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1046" class="10:46" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:46</td>
                                                        <td><span id="nome_paciente46"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1047" class="10:47" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:47</td>
                                                        <td><span id="nome_paciente47"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1048" class="10:48" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:48</td>
                                                        <td><span id="nome_paciente48"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1049" class="10:49" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:49</td>
                                                        <td><span id="nome_paciente49"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1050" class="10:50" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:50</td>
                                                        <td><span id="nome_paciente50"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1051" class="10:51" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:51</td>
                                                        <td><span id="nome_paciente51"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1052" class="10:52" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:52</td>
                                                        <td><span id="nome_paciente52"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1053" class="10:53" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:53</td>
                                                        <td><span id="nome_paciente53"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1054" class="10:54" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:54</td>
                                                        <td><span id="nome_paciente54"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1055" class="10:55" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:55</td>
                                                        <td><span id="nome_paciente55"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1056" class="10:56" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:56</td>
                                                        <td><span id="nome_paciente56"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1057" class="10:57" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:57</td>
                                                        <td><span id="nome_paciente57"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1058" class="10:58" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:58</td>
                                                        <td><span id="nome_paciente58"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1059" class="10:59" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:59</td>
                                                        <td><span id="nome_paciente59"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1060" class="10:60" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:60</td>
                                                        <td><span id="nome_paciente6"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1070" class="10:70" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:70</td>
                                                        <td><span id="nome_paciente7"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1080" class="10:80" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:80</td>
                                                        <td><span id="nome_paciente8"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1090" class="10:90" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 10:90</td>
                                                        <td><span id="nome_paciente9"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1100" class="11:00" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:00</td>
                                                        <td><span id="nome_paciente60"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1110" class="11:10" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:10</td>
                                                        <td><span id="nome_paciente70"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1111" class="11:11" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:11</td>
                                                        <td><span id="nome_paciente71"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1112" class="11:12" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:12</td>
                                                        <td><span id="nome_paciente72"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1113" class="11:13" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:13</td>
                                                        <td><span id="nome_paciente73"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1114" class="11:14" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:14</td>
                                                        <td><span id="nome_paciente74"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1115" class="11:15" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:15</td>
                                                        <td><span id="nome_paciente75"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1116" class="11:16" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:16</td>
                                                        <td><span id="nome_paciente76"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1117" class="11:17" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:17</td>
                                                        <td><span id="nome_paciente77"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1118" class="11:18" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:18</td>
                                                        <td><span id="nome_paciente78"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1119" class="11:19" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:19</td>
                                                        <td><span id="nome_paciente79"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1120" class="11:20" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:20</td>
                                                        <td><span id="nome_paciente80"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1121" class="11:21" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:21</td>
                                                        <td><span id="nome_paciente81"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1122" class="11:22" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:22</td>
                                                        <td><span id="nome_paciente82"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1123" class="11:23" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:23</td>
                                                        <td><span id="nome_paciente83"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1124" class="11:24" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:24</td>
                                                        <td><span id="nome_paciente84"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1125" class="11:25" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:25</td>
                                                        <td><span id="nome_paciente85"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1126" class="11:26" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:26</td>
                                                        <td><span id="nome_paciente86"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1127" class="11:27" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:27</td>
                                                        <td><span id="nome_paciente87"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1128" class="11:28" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:28</td>
                                                        <td><span id="nome_paciente88"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1129" class="11:29" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:29</td>
                                                        <td><span id="nome_paciente89"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1130" class="11:30" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:30</td>
                                                        <td><span id="nome_paciente90"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1131" class="11:31" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:31</td>
                                                        <td><span id="nome_paciente91"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1132" class="11:32" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:32</td>
                                                        <td><span id="nome_paciente92"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1133" class="11:33" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:33</td>
                                                        <td><span id="nome_paciente93"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1134" class="11:34" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:34</td>
                                                        <td><span id="nome_paciente94"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1135" class="11:35" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:35</td>
                                                        <td><span id="nome_paciente95"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1136" class="11:36" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:36</td>
                                                        <td><span id="nome_paciente96"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1137" class="11:37" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:37</td>
                                                        <td><span id="nome_paciente97"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1138" class="11:38" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:38</td>
                                                        <td><span id="nome_paciente98"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1139" class="11:39" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:39</td>
                                                        <td><span id="nome_paciente99"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1140" class="11:40" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:40</td>
                                                        <td><span id="nome_paciente100"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1141" class="11:41" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:41</td>
                                                        <td><span id="nome_paciente101"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1142" class="11:42" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:42</td>
                                                        <td><span id="nome_paciente102"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1143" class="11:43" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:43</td>
                                                        <td><span id="nome_paciente103"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1144" class="11:44" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:44</td>
                                                        <td><span id="nome_paciente104"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1145" class="11:45" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:45</td>
                                                        <td><span id="nome_paciente105"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1146" class="11:46" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:46</td>
                                                        <td><span id="nome_paciente106"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1147" class="11:47" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:47</td>
                                                        <td><span id="nome_paciente107"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1148" class="11:48" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:48</td>
                                                        <td><span id="nome_paciente108"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1149" class="11:49" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:49</td>
                                                        <td><span id="nome_paciente109"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1150" class="11:50" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:50</td>
                                                        <td><span id="nome_paciente110"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1151" class="11:51" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:51</td>
                                                        <td><span id="nome_paciente111"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1152" class="11:52" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:52</td>
                                                        <td><span id="nome_paciente112"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1153" class="11:53" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:53</td>
                                                        <td><span id="nome_paciente113"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1154" class="11:54" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:54</td>
                                                        <td><span id="nome_paciente114"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1155" class="11:55" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:55</td>
                                                        <td><span id="nome_paciente115"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1156" class="11:56" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:56</td>
                                                        <td><span id="nome_paciente116"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1157" class="11:57" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:57</td>
                                                        <td><span id="nome_paciente117"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1158" class="11:58" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:58</td>
                                                        <td><span id="nome_paciente118"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1159" class="11:59" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:59</td>
                                                        <td><span id="nome_paciente119"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1160" class="11:60" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:60</td>
                                                        <td><span id="nome_paciente66"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1170" class="11:70" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:70</td>
                                                        <td><span id="nome_paciente67"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1180" class="11:80" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:80</td>
                                                        <td><span id="nome_paciente68"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr id="1190" class="11:90" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)">
                                                        <td> 11:90</td>
                                                        <td><span id="nome_paciente69"></span></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <!-- marca_consulta -->
                                </div>
                                <!-- LEFT -->                              
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                    </tfoot>
                </table>
            </div>
        </div>
        <!-- MODAL GERAL INICIO -->
        <button id="btnModalGeral" style="display: none;" type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModalGeral">Open Modal</button>
        <!-- Modal -->    
        <div class="modal fade" id="myModalGeral" role="dialog" tabindex="-1">
            <div class="modal-dialog modal-sm">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header bg-darkblue"></div>
                    <div class="modal-body"></div>
                    <div class="modal-footer"></div>
                </div>
            </div>
        </div>
        <!-- MODAL GERAL FIM -->
        <!-- MODAL GERAL 2 INICIO -->
        <button id="btnModalGeral2" style="display: none;" type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModalGeral2">Open Modal</button>
        <!-- Modal -->    
        <div class="modal fade" id="myModalGeral2" role="dialog" tabindex="-1">
            <div class="modal-dialog modal-sm">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header bg-darkblue">
                        <button type="button" class="close" data-dismiss="modal">×</button>
                    </div>
                    <div class="modal-body"></div>
                    <div class="modal-footer"></div>
                </div>
            </div>
        </div>
        <!-- MODAL GERAL 2 FIM -->
        <!-- MODAL GERAL 3 médio INICIO -->
        <button id="btnModalGeral3" style="display: none;" type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModalGeral3">Open Modal</button>
        <!-- Modal -->    
        <div class="modal fade" id="myModalGeral3" role="dialog" tabindex="-1">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header bg-darkblue">
                        <button type="button" class="close" data-dismiss="modal">×</button>
                    </div>
                    <div class="modal-body"></div>
                    <div class="modal-footer"></div>
                </div>
            </div>
        </div>
        <!-- MODAL GERAL 3 FIM -->
        <!-- MODAL Bloqueio INICIO -->
        <button id="btnModalBloqueio" style="display: none;" type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModalBloqueio">Open Modal</button>
        <div class="modal fade" id="myModalBloqueio" role="dialog" tabindex="-1">
            <div class="modal-dialog modal-sm">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header bg-darkblue">
                        <button type="button" class="close" data-dismiss="modal">×</button>
                        <h4 class="modal-title modal-title-darkblue">Bloqueio:</h4>
                    </div>
                    <div class="modal-body">
                        <form>
                            <input type="hidden" id="hora_modal_b">
                            <div class="form-group">
                                <label for="agm_bloqueio_descricao_b">Descrição do Bloqueio</label>
                                <input type="text" class="form-control" id="agm_bloqueio_descricao_b" name="agm_bloqueio_descricao_b">
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" data-dismiss="modal" class="btn btn-primary pull-right" onclick="bloquearHorario_continuar()">Concluir Bloqueio</button>
                        <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Cancelar</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- MODAL Bloqueio FIM -->
        <!-- Modal Registro de Agendamento -->
        <div id="myModal" class="modal fade" role="dialog" style="display: none;">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header bg-darkblue">
                        <button type="button" class="close" data-dismiss="modal">×</button>
                        <h4 class="modal-title modal-title-primary">
                            Agendamento para às <span id="modal-title" class="modal-title">10:10</span> horas<br>
                            No dia: <span id="data-modal" class="modal-title">13/07/2016</span>
                        </h4>
                    </div>
                    <div class="modal-body">
                        <form>
                            <input type="hidden" id="hora_modal" value="">
                            <input type="hidden" id="id_beneficiarios" value="">
                            <div class="form-group col-sm-4" style="padding-left: 0;">
                                <label for="id_tipo_agendamento">Tipo do Agendamento<span class="text-danger">*</span></label>
                            </div>
                            <div class="form-group col-sm-8" style="padding-left: 0;">
                                <select name="id_tipo_agendamento" id="id_tipo_agendamento" class="form-control input-sm">
                                    <option value="0">Selecione ---</option>
                                    <option value="1">Consulta</option>
                                    <option value="2">Retorno</option>
                                    <option value="3">Exame</option>
                                </select>
                            </div>
                            <div class="clearfix"></div>
                            <div class="form-group col-sm-12" style="padding-left: 0;">
                                <label for="agm_paciente_nome">Nome do Paciente<span class="text-danger">*</span></label><span id="data-ultima-consulta" style="margin-left:20px;"></span>
                                <div class="select2-container form-control input-sm" id="s2id_agm_paciente_nome"><a href="javascript:void(0)" class="select2-choice select2-default" tabindex="-1">   <span class="select2-chosen" id="select2-chosen-1"></span><abbr class="select2-search-choice-close"></abbr>   <span class="select2-arrow" role="presentation"><b role="presentation"></b></span></a><label for="s2id_autogen1" class="select2-offscreen">Nome do Paciente*</label><input class="select2-focusser select2-offscreen" type="text" aria-haspopup="true" role="button" aria-labelledby="select2-chosen-1" id="s2id_autogen1"></div>
                                <input type="text" name="agm_paciente_nome" value="" id="agm_paciente_nome" placeholder="Informe o nome do paciente" class="form-control input-sm" tabindex="-1" title="Nome do Paciente*" style="display: none;">
                            </div>
                            <div class="clearfix"></div>
                            <div class="form-group col-sm-4" style="padding-left: 0;">
                                <label for="agm_paciente_telefone">Telefone Celular<span class="text-danger">*</span></label>
                                <input type="text" name="agm_paciente_telefone" value="" id="agm_paciente_telefone" class="form-control input-sm" maxlength="11">
                            </div>
                            <div class="form-group col-sm-4" style="padding-left: 0;">
                                <label for="agm_paciente_telefone_fixo">Telefone Fixo </label>
                                <input type="text" class="form-control" id="agm_paciente_telefone_fixo" name="agm_paciente_telefone_fixo" maxlength="11">
                            </div>
                            <div class="form-group col-sm-4" style="padding-left: 0;">
                                <label for="agm_paciente_email">E-mail</label>
                                <input type="text" class="form-control" id="agm_paciente_email" name="agm_paciente_email" placeholder="E-mail" maxlength="100">
                            </div>
                            <div class="clearfix"></div>
                            <div class="form-group col-sm-4" style="padding-left: 0;">
                                <label for="id_operadoras"><font class="require"></font>Convênio/Plano de saúde<span class="text-danger">*</span></label>
                            </div>
                            <div class="form-group col-sm-8" style="padding-left: 0;">
                                <select name="id_operadoras" id="id_operadoras" class="form-control input-sm">
                                    <option value="0">Particular</option>
                                </select>
                            </div>
                            <div class="clearfix"></div>
                            <div class="form-group col-sm-12" style="padding-left: 0;">
                                <label for="agm_observacao">Observações</label>
                                <textarea class="form-control" rows="3" id="agm_observacao" name="agm_observacao"></textarea> 
                            </div>
                            <div class="clearfix"></div>
                            <div class="form-group">
                                <div class="checkbox">
                                    <label>
                                    <input type="checkbox" id="agm_primeira_consulta"> 1º Consulta
                                    </label>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="bt_modal_ok" data-dismiss="modal" class="btn btn-primary pull-right">Gravar Agendamento</button>
                        <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Cancelar</button>
                        <button type="button" class="btn btn-default pull-left" data-dismiss="modal" onclick="bloquearHorario()">Bloquear este horário</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal Registro de Encaixe -->
        <div id="myModalEncaixe" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header bg-darkblue">
                        <button type="button" class="close" data-dismiss="modal">×</button>
                        <h4 class="modal-title modal-title-darkblue">Agendamento de Encaixe</h4>
                    </div>
                    <div class="modal-body">
                        <form>
                            <input type="hidden" id="id_beneficiarios_e">
                            <div class="col-sm-12 info-board info-board-red" style="padding-bottom: 5px; margin-top: 0;">
                                <div class="form-group col-sm-3" style="padding-left: 0;">
                                    <label for="id_tipo_agendamento_e">Encaixe para:</label>
                                </div>
                                <div class="form-group col-sm-1" style="padding-left: 0;">
                                    <label for="agm_paciente_data_e">Data<span class="text-danger">*</span></label>
                                </div>
                                <div class="form-group col-sm-4" style="padding-left: 0;">
                                    <div id="agm_paciente_data_e_datepicker" class="input-group date">
                                        <input type="text" name="agm_paciente_data_e" value="" id="agm_paciente_data_e" class="form-control input-sm clsDatePicker hasDatepicker" data-mask="99/99/9999">
                                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                                <div class="form-group col-sm-3" style="padding-left: 0;">
                                    <label for="agm_paciente_hora_e">Hora Inicial<span class="text-danger">*</span></label>
                                </div>
                                <div class="form-group col-sm-2" style="padding-left: 0;">
                                    <input type="text" class="form-control" id="agm_paciente_hora_e" name="agm_paciente_hora_e" data-mask="99:99">                            
                                </div>
                                <div id="hora_final_encaixe_bloco" style="display: none;">
                                    <div class="form-group col-sm-3" style="padding-left: 0;">
                                        <label for="agm_paciente_hora_final_e">Hora Final</label>
                                    </div>
                                    <div class="form-group col-sm-2" style="padding-left: 0;">
                                        <input type="text" class="form-control" id="agm_paciente_hora_final_e" name="agm_paciente_hora_final_e" data-mask="99:99">
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                                <div class="form-group col-sm-5" style="padding-left: 0;">
                                    <input type="checkbox" onclick="bloco_hora_final_encaixe()"> Horario extendido
                                </div>
                                <div class="clearfix"></div>
                                NOTA: Informe no campo <strong>Horário</strong> a hora para agendamento do encaixe.
                            </div>
                            <div class="clearfix"></div>
                            <div class="form-group col-sm-4" style="padding-left: 0;">
                                <label for="id_tipo_agendamento_e">Tipo do Agendamento<span class="text-danger">*</span></label>
                            </div>
                            <div class="form-group col-sm-8" style="padding-left: 0;">
                                <select name="id_tipo_agendamento_e" id="id_tipo_agendamento_e" class="form-control input-sm">
                                    <option value="0">Selecione ---</option>
                                    <option value="1">Consulta</option>
                                    <option value="2">Retorno</option>
                                    <option value="3">Exame</option>
                                </select>
                            </div>
                            <div class="clearfix"></div>
                            <div class="form-group col-sm-12" style="padding-left: 0;">
                                <label for="agm_paciente_nome_e">Nome do Paciente<span class="text-danger">*</span></label>
                                <div class="select2-container form-control input-sm" id="s2id_agm_paciente_nome_e">
                                    <a href="javascript:void(0)" class="select2-choice select2-default" tabindex="-1">   <span class="select2-chosen" id="select2-chosen-2">Buscar...</span><abbr class="select2-search-choice-close"></abbr>   <span class="select2-arrow" role="presentation"><b role="presentation"></b></span></a><label for="s2id_autogen2" class="select2-offscreen">Nome do Paciente*</label><input class="select2-focusser select2-offscreen" type="text" aria-haspopup="true" role="button" aria-labelledby="select2-chosen-2" id="s2id_autogen2">
                                    <div class="select2-drop select2-display-none bigdrop select2-with-searchbox">
                                        <div class="select2-search">       <label for="s2id_autogen2_search" class="select2-offscreen">Nome do Paciente*</label>       <input type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="select2-input" role="combobox" aria-expanded="true" aria-autocomplete="list" aria-owns="select2-results-2" id="s2id_autogen2_search" placeholder="">   </div>
                                        <ul class="select2-results" role="listbox" id="select2-results-2">   </ul>
                                    </div>
                                </div>
                                <input type="text" name="agm_paciente_nome_e" value="" id="agm_paciente_nome_e" class="form-control input-sm" tabindex="-1" title="Nome do Paciente*" style="display: none;">
                            </div>
                            <div class="clearfix"></div>
                            <div class="form-group col-sm-4" style="padding-left: 0;">
                                <label for="agm_paciente_telefone_e">Telefone Celular<span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="agm_paciente_telefone_e" name="agm_paciente_telefone_e" maxlength="11">
                            </div>
                            <div class="form-group col-sm-4" style="padding-left: 0;">
                                <label for="agm_paciente_telefone_fixo_e">Telefone Fixo </label>
                                <input type="text" class="form-control" id="agm_paciente_telefone_fixo_e" name="agm_paciente_telefone_fixo_e" maxlength="11">
                            </div>
                            <div class="form-group col-sm-4" style="padding-left: 0;">
                                <label for="agm_paciente_email_e">E-mail</label>
                                <input type="text" class="form-control" id="agm_paciente_email_e" name="agm_paciente_email_e" placeholder="E-mail">
                            </div>
                            <div class="form-group col-sm-4" style="padding-left: 0;">
                                <label for="id_operadoras_e"><font class="require"></font>Convênio/Plano de saúde<span class="text-danger">*</span></label>
                            </div>
                            <div class="form-group col-sm-8" style="padding-left: 0;">
                                <select name="id_operadoras_e" id="id_operadoras_e" class="form-control input-sm">
                                    <option value="0">Particular</option>
                                </select>
                            </div>
                            <div class="clearfix"></div>
                            <div class="form-group col-sm-12" style="padding-left: 0;">
                                <label for="agm_observacao_e">Observações</label>
                                <textarea class="form-control" rows="3" id="agm_observacao_e" name="agm_observacao_e"></textarea> 
                            </div>
                            <div class="clearfix"></div>
                            <div class="form-group">
                                <div class="checkbox">
                                    <label>
                                    <input type="checkbox" id="agm_primeira_consulta_e"> 1º Consulta
                                    </label>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="gravar_encaixe()">Gravar Encaixe</button>
                        <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Cancelar</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal Informações do Agendamento -->
        <div id="myModalConfirmar" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header bg-darkblue">
                        <button type="button" class="close" data-dismiss="modal">×</button>
                        <h4 class="modal-title modal-title-primary">
                            Agendamento para às <span id="modal-title_c" class="modal-title"></span> horas<br>
                            No dia: <span id="data-modal_c" class="modal-title"></span>
                        </h4>
                    </div>
                    <div class="modal-body">
                        <form>
                            <input type="hidden" id="hora_modal_c">
                            <input type="hidden" id="id_agendas_marcacoes_c">
                            <input type="hidden" id="id_beneficiarios_c">
                            <input type="hidden" id="id_operadoras_cadastrado">
                            <div class="form-group col-sm-4" style="padding-left: 0;">
                                <label for="id_tipo_agendamento_c">Tipo do Agendamento<span class="text-danger">*</span></label>
                            </div>
                            <div class="form-group col-sm-8" style="padding-left: 0;">
                                <select name="id_tipo_agendamento_c" id="id_tipo_agendamento_c" class="form-control input-sm">
                                    <option value="0">Selecione ---</option>
                                    <option value="1">Consulta</option>
                                    <option value="2">Retorno</option>
                                    <option value="3">Exame</option>
                                </select>
                            </div>
                            <div class="clearfix"></div>
                            <div class="form-group col-sm-12" style="padding-left: 0;">
                                <label for="agm_paciente_nome_c">Nome do Paciente</label>
                                <div class="select2-container form-control" id="s2id_agm_paciente_nome_c">
                                    <a href="javascript:void(0)" class="select2-choice select2-default" tabindex="-1">   <span class="select2-chosen" id="select2-chosen-3">Nome</span><abbr class="select2-search-choice-close"></abbr>   <span class="select2-arrow" role="presentation"><b role="presentation"></b></span></a><label for="s2id_autogen3" class="select2-offscreen">Nome do Paciente</label><input class="select2-focusser select2-offscreen" type="text" aria-haspopup="true" role="button" aria-labelledby="select2-chosen-3" id="s2id_autogen3">
                                    <div class="select2-drop select2-display-none bigdrop select2-with-searchbox">
                                        <div class="select2-search">       <label for="s2id_autogen3_search" class="select2-offscreen">Nome do Paciente</label>       <input type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="select2-input" role="combobox" aria-expanded="true" aria-autocomplete="list" aria-owns="select2-results-3" id="s2id_autogen3_search" placeholder="">   </div>
                                        <ul class="select2-results" role="listbox" id="select2-results-3">   </ul>
                                    </div>
                                </div>
                                <input type="text" class="form-control" id="agm_paciente_nome_c" name="agm_paciente_nome_c" placeholder="Nome" tabindex="-1" title="Nome do Paciente" style="display: none;">
                            </div>
                            <div class="form-group col-sm-4" style="padding-left: 0;">
                                <label for="agm_paciente_telefone_c">Telefone Celular</label>
                                <input type="text" class="form-control" id="agm_paciente_telefone_c" name="agm_paciente_telefone_c" maxlength="11">
                            </div>
                            <div class="form-group col-sm-4" style="padding-left: 0;">
                                <label for="agm_paciente_telefone_fixo_c">Telefone Fixo </label>
                                <input type="text" class="form-control" id="agm_paciente_telefone_fixo_c" name="agm_paciente_telefone_fixo_c" maxlength="11">
                            </div>
                            <div class="form-group col-sm-4" style="padding-left: 0;">
                                <label for="agm_paciente_email_c">E-mail</label>
                                <input type="text" class="form-control" id="agm_paciente_email_c" name="agm_paciente_email_c" placeholder="E-mail" maxlength="100">
                            </div>
                            <div class="clearfix"></div>
                            <div class="form-group col-sm-4" style="padding-left: 0;">
                                <label for="id_operadoras_c"><font class="require"></font>Convênio/Plano de saúde<span class="text-danger">*</span></label>
                            </div>
                            <div class="form-group col-sm-8" style="padding-left: 0;">
                                <select name="id_operadoras_c" id="id_operadoras_c" class="form-control input-sm" onchange="mostraCamposConvenio();">
                                    <option value="0">Particular</option>
                                </select>
                            </div>
                            <div class="clearfix"></div>
                            <div id="atendimento_convenio" class="require" style="visibility:hidden; display:none">
                                <div class="form-group col-sm-8" style="padding-left: 0;">
                                    <label for="ben_numero_carteira_c">Número da Carteira na Operadora</label>
                                    <input type="text" class="form-control" id="ben_numero_carteira_c" name="ben_numero_carteira_c" placeholder="Número Carteira" maxlength="100">
                                </div>
                                <div class="form-group col-sm-4" style="padding-left: 0;">
                                    <label for="ben_validade_carteira_c">Validade da Carteira</label>
                                    <input type="text" class="form-control hasDatepicker" id="ben_validade_carteira_c" name="ben_validade_carteira_c" placeholder="Validade da Carteira" data-mask="99/99/9999">
                                </div>
                                <div class="clearfix"></div>
                            </div>
                            <div class="form-group col-sm-12" style="padding-left: 0;">
                                <label for="agm_observacao_c">Observações</label>
                                <textarea class="form-control" rows="3" id="agm_observacao_c" name="agm_observacao_c" placeholder=""></textarea> 
                            </div>
                            <div class="clearfix"></div>
                            <div class="form-group">
                                <div class="checkbox">
                                    <label for="agm_primeira_consulta_c">
                                    <input type="checkbox" id="agm_primeira_consulta_c" name="agm_primeira_consulta_c"> 1º Consulta
                                    </label>
                                    <br>
                                    <label for="agm_agendamento_confirmado_c">
                                    <input type="checkbox" id="agm_agendamento_confirmado_c" name="agm_agendamento_confirmado_c"> Agendamento Confirmado
                                    </label>
                                    <br>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <div class="btn-group">
                            <a class="btn btn-primary" href="#" id="bt_modal_ok_cp" data-dismiss="modal" onclick="confirmar_presenca();return false;">Paciente na Recepção </a>
                            <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#" aria-expanded="false"><span class="fa fa-caret-down"></span></a>
                            <ul class="dropdown-menu">
                                <li><a href="#" id="bt_modal_rf" data-dismiss="modal" onclick="registrar_falta();return false;"><i class="fa fa-ban fa-fw"></i>Paciente Faltou</a></li>
                                <li><a href="#" id="bt_modal_rgd" data-dismiss="modal" onclick="reagendar_agendamento();return false;"><i class="fa fa-pencil fa-fw"></i>Reagendar</a></li>
                            </ul>
                        </div>
                        <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Cancelar</button>
                        <button type="button" class="btn btn-default pull-left" data-dismiss="modal" onclick="excluir_agendamento()">Excluir</button>
                        <button type="button" id="bt_modal_ok_sf" data-dismiss="modal" class="btn btn-primary pull-left" onclick="salvar_e_fechar()">Salvar e Fechar</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal Reagendamento INICIO-->
        <button id="btnModalReagendamento" style="display: none;" type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#ModalReagendamento">Open Modal</button>
        <div id="ModalReagendamento" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header bg-darkblue">
                        <button type="button" class="close" data-dismiss="modal">×</button>
                        <h4 class="modal-title modal-title-primary">
                            Agendamento para às <span id="modal-title_r" class="modal-title"></span> horas<br>
                            No dia: <span id="data-modal_r" class="modal-title"></span><br>
                            Paciente: <span id="paciente_nome_r" class="modal_tile"></span>
                        </h4>
                    </div>
                    <div class="modal-body">
                        <form>
                            <input type="hidden" id="id_agendas_marcacoes_r">
                            <input type="hidden" id="id_beneficiarios_r">
                            <div class="col-sm-12 info-board info-board-red" style="padding-bottom: 5px; margin-top: 0;">
                                <div class="form-group col-sm-12" style="padding-left: 0;">
                                    <label for="id_tipo_agendamento_r"><strong>Reagendar para:</strong></label>
                                </div>
                                <div class="clearfix"></div>
                                <div class="form-group col-sm-3" style="padding-left: 0;">
                                    <label for="agm_paciente_data_r">Data:<span class="text-danger">*</span></label>
                                </div>
                                <div class="form-group col-sm-4" style="padding-left: 0;">
                                    <div id="agm_paciente_data_e_datepicker" class="input-group date">
                                        <input type="text" name="agm_paciente_data_r" value="" id="agm_paciente_data_r" class="form-control input-sm calendar clsDatePicker hasDatepicker" data-mask="99/99/9999">
                                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                                <div class="form-group col-sm-3" style="padding-left: 0;">
                                    <label for="agm_paciente_hora_r">Horário:<span class="text-danger">*</span></label>
                                </div>
                                <div class="form-group col-sm-5" style="padding-left: 0;">
                                    <input type="text" class="form-control" id="agm_paciente_hora_r" name="agm_paciente_hora_r" data-mask="99:99">
                                </div>
                            </div>
                            <div class="clearfix"></div>
                        </form>
                        <div class="col-sm-12">
                            NOTA:<br> Informe nos campos <strong>Data e Horário</strong> a data e hora para reagendamento da marcação.
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="gravar_reagendamento()">Reagendar</button>
                        <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Cancelar</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal Reagendamento FIM -->
        <!-- MODAL Faturamento INICIO -->
        <button id="btnModalFaturamento" style="display: none;" type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#ModalFaturamento">Open Modal</button>
        <div class="modal fade" id="ModalFaturamento" role="dialog" tabindex="-1">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header bg-darkblue">
                        <button type="button" class="close" data-dismiss="modal">×</button>
                        <h4 class="modal-title modal-title-darkblue">Faturar Atendimento:</h4>
                    </div>
                    <div class="modal-body">
                        <div>
                            <div class="form-group col-sm-12">
                                Profissional: <strong><span id="profissional_nome_fat" class="modal_tile"></span></strong><br>
                                Paciente: <strong><span id="paciente_nome_fat" class="modal_tile"></span></strong><br>
                                Atendimento: <span id="data_hora_fat" class="modal_title"></span>
                            </div>
                            <div class="clearfix"></div>
                            <form>
                                <input type="hidden" id="id_beneficiarios_fat">                     
                                <input type="hidden" id="id_horario_dia_fat">
                                <input type="hidden" id="id_agendas_fat">
                                <input type="hidden" id="id_agendas_marcacoes_fat">
                                <div class="form-group col-sm-2 text-align-right" style="padding-left: 0;">
                                    <label for="ben_cpf">CPF:<span class="text-danger">*</span></label>
                                </div>
                                <div class="form-group col-sm-3" style="padding-left: 0;">
                                    <input type="text" name="ben_cpf" value="" id="ben_cpf" data-mask="999.999.999-99" class="form-control input-sm" onblur="validatePessoa();">
                                </div>
                                <div class="form-group col-sm-3 text-align-right" style="padding-left: 0;">
                                    <label for="id_aux_formas_pagamento">Forma de Pagamento:<span class="text-danger">*</span></label>
                                </div>
                                <div class="form-group col-sm-3" style="padding-left: 0;">
                                    <select name="id_aux_formas_pagamento" id="id_aux_formas_pagamento" class="form-control input-sm">
                                        <option value="1">Dinheiro</option>
                                        <option value="2">Cheque</option>
                                        <option value="3">Cartão Crédito</option>
                                        <option value="4">Cartão Débito</option>
                                        <option value="5">Boleto</option>
                                    </select>
                                </div>
                                <div class="clearfix"></div>
                                <div class="form-group col-sm-2 text-align-right" style="padding-left: 0;">
                                    <label for="lcm_valor">Valor:<span class="text-danger">*</span></label>
                                </div>
                                <div class="form-group col-sm-3" style="padding-left: 0;">
                                    <div class="input-group margin-botton-sm">
                                        <span class="input-group-addon"><i class="fa fa-money fa-fw" aria-hidden="true"></i></span>
                                        <input type="text" name="lcm_valor" value="" id="lcm_valor" placeholder="0,00" class="form-control input-sm">
                                    </div>
                                </div>
                                <div class="form-group col-sm-3 text-align-right" style="padding-left: 0;">
                                    <label for="desc_tuss_procedimento">Código procedimento:</label>
                                </div>
                                <div class="form-group col-sm-3" style="padding-left: 0;">
                                    <input type="hidden" name="id_tuss_procedimento" value="9" id="id_tuss_procedimento">
                                    <div class="select2-container form-control input-sm" id="s2id_desc_tuss_procedimento">
                                        <a href="javascript:void(0)" class="select2-choice" tabindex="-1">   <span class="select2-chosen" id="select2-chosen-4">10104020 - Atendimento médico do intensivista em UTI geral ou pediátrica (plantão de 12 horas - por paciente)</span><abbr class="select2-search-choice-close"></abbr>   <span class="select2-arrow" role="presentation"><b role="presentation"></b></span></a><label for="s2id_autogen4" class="select2-offscreen">Código procedimento:</label><input class="select2-focusser select2-offscreen" type="text" aria-haspopup="true" role="button" aria-labelledby="select2-chosen-4" id="s2id_autogen4">
                                        <div class="select2-drop select2-display-none bigdrop select2-with-searchbox">
                                            <div class="select2-search">       <label for="s2id_autogen4_search" class="select2-offscreen">Código procedimento:</label>       <input type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="select2-input" role="combobox" aria-expanded="true" aria-autocomplete="list" aria-owns="select2-results-4" id="s2id_autogen4_search" placeholder="">   </div>
                                            <ul class="select2-results" role="listbox" id="select2-results-4">   </ul>
                                        </div>
                                    </div>
                                    <input type="text" name="desc_tuss_procedimento" value=" - " id="desc_tuss_procedimento" class="form-control input-sm" tabindex="-1" title="Código procedimento:" style="display: none;">
                                </div>
                                <div class="clearfix"></div>
                                <div class="form-group col-sm-2 text-align-right" style="padding-left: 0;">
                                    <label for="id_contas_bancarias">Conta:<span class="text-danger">*</span></label>
                                </div>
                                <div class="form-group col-sm-3" style="padding-left: 0;">
                                    <select name="id_contas_bancarias" id="id_contas_bancarias" class="form-control input-sm">
                                    </select>
                                </div>
                                <div class="form-group col-sm-3 text-align-right" style="padding-left: 0;">
                                    <label for="id_centro_custo">Centro de custo:</label>
                                </div>
                                <div class="form-group col-sm-3" style="padding-left: 0;">
                                    <select name="id_centro_custo" id="id_centro_custo" class="form-control input-sm">
                                        <option value="0">Selecione ---</option>
                                    </select>
                                </div>
                                <div class="clearfix"></div>
                                <div class="form-group col-sm-2 text-align-right" style="padding-left: 0;">
                                    <label for="vcm_vencimento">Vencimento:<span class="text-danger">*</span></label>
                                </div>
                                <div class="form-group col-sm-3" style="padding-left: 0;">
                                    <div id="agm_paciente_data_e_datepicker" class="input-group date">
                                        <input type="text" name="vcm_vencimento" value="" id="vcm_vencimento" class="form-control input-sm calendar clsDatePicker hasDatepicker" data-mask="99/99/9999">
                                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                    </div>
                                </div>
                                <div class="form-group col-sm-3 text-align-right" style="padding-left: 0;">
                                    <label for="vcm_pago">Pago</label>
                                </div>
                                <div class="form-group col-sm-2" style="padding-left: 0;">
                                    <input type="checkbox" name="vcm_pago" value="S" id="vcm_pago">
                                </div>
                                <div class="clearfix"></div>
                            </form>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" data-dismiss="modal" class="btn btn-success pull-right" onclick="faturar_atendimento()">Faturar Atendimento</button>
                        <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Cancelar</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- MODAL Faturamento FIM -->
        <script type="text/javascript">
            $(function () {
            
                /*-----------------------------------------------------------------------
                | Reagendamento
                | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                | Em : 25/04/2016
                |----------------------------------------------------------------------*/
                $("#agm_paciente_data_r").datepicker({
                    showButtonPanel: true,
                    changeMonth: true,
                    changeYear: true,
                    currentText: 'Hoje',
                    closeText: 'Fechar',
                    dateFormat: 'dd/mm/yy',
                    dayNames: ['Domingo', 'Segunda', 'Terça', 'Quarta', 'Quinta', 'Sexta', 'Sábado', 'Domingo'],
                    dayNamesMin: ['D', 'S', 'T', 'Q', 'Q', 'S', 'S', 'D'],
                    dayNamesShort: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                    monthNames: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
                    monthNamesShort: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
                    onSelect: function (dateText, inst) {
                        dd = $("#agm_paciente_data_r").datepicker('getDate').getDate();
                        mm = $("#agm_paciente_data_r").datepicker('getDate').getMonth() + 1; //Janeiro é 0!
                        yyyy = $("#agm_paciente_data_r").datepicker('getDate').getFullYear();
                        data_p = yyyy+'-'+checkMm(mm)+'-'+checkDd(dd);
                        obter_dados_post_r(data_p);
                    }
                });
                
            $('.calendar').datepicker({
                    showButtonPanel: true,
                    changeMonth: true,
                    changeYear: true,
                    currentText: 'Hoje',
                    closeText: 'Fechar',
            dateFormat: "dd/mm/yy",
            dayNames: ['Domingo','Segunda','Terça','Quarta','Quinta','Sexta','Sábado'],
            dayNamesMin: ['D','S','T','Q','Q','S','S','D'],
            dayNamesShort: ['Dom','Seg','Ter','Qua','Qui','Sex','Sáb','Dom'],
            monthNames: ['Janeiro','Fevereiro','Março','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'],
            monthNamesShort: ['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'],
            nextText: 'Próximo',
            prevText: 'Anterior'
            }); 
            
                /*-----------------------------------------------------------------------
                | Para o encaixe
                | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                | Em : 20/06/2016
                |----------------------------------------------------------------------*/
                $('#agm_paciente_data_e').datepicker({
                    showButtonPanel: true,
                    changeMonth: true,
                    changeYear: true,
                    currentText: 'Hoje',
                    closeText: 'Fechar',
                    dateFormat: "dd/mm/yy",
                    dayNames: ['Domingo','Segunda','Terça','Quarta','Quinta','Sexta','Sábado'],
                    dayNamesMin: ['D','S','T','Q','Q','S','S','D'],
                    dayNamesShort: ['Dom','Seg','Ter','Qua','Qui','Sex','Sáb','Dom'],
                    monthNames: ['Janeiro','Fevereiro','Março','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'],
                    monthNamesShort: ['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'],
                    nextText: 'Próximo',
                    prevText: 'Anterior'
                }); 
            
            $('#ben_validade_carteira').datepicker({
                    showButtonPanel: true,
                    changeMonth: true,
                    changeYear: true,
                    currentText: 'Hoje',
                    closeText: 'Fechar',
            dateFormat: 'dd-mm-yy',
            minDate: '+5d',
            changeMonth: true,
            changeYear: true,
            altField: "#idTourDateDetailsHidden",
            altFormat: "yy-mm-dd"
            });
            
            });
            
            $('#myModalBloqueio').on('hidden.bs.modal', function () {
                $('#agm_bloqueio_descricao_b').val('');
            });
            
            $('#myModal').on('hidden.bs.modal', function () {
                $('#hora_modal').val('');
                $('#id_beneficiarios').val('');
                $('#select2-chosen-1').html('');
                $('#agm_paciente_nome').val('');
                $('#agm_paciente_email').val('');
                $('#agm_paciente_telefone').val('');
                $('#agm_paciente_telefone_fixo').val('');
                $('#id_operadoras').val('');
                $('#multi_agendamento').val('');
                $('#agm_observacao').val('');
                $('#agm_primeira_consulta').prop('checked', false);
                document.getElementById('data-ultima-consulta').innerHTML = ('');
            });
            
            $('#myModalConfirmar_off').on('hidden.bs.modal', function () {
                $('#hora_modal_c').val('');
                $('#id_agendas_marcacoes_c').val('');
                $('#id_beneficiarios_c').val('');
                $('#agm_paciente_email_c').val('');
                $('#id_operadoras_c').val('');
                $('#agm_paciente_nome_c').val('');
                $('#ben_numero_carteira_c').val('');
                $('#ben_validade_carteira_c').val('');
                $('#agm_paciente_telefone_c').val('');
                $('#agm_paciente_telefone_fixo_c').val('');        
                $('#agm_observacao_c').val('');
                $('#agm_primeira_consulta_c').prop('checked', false);
                $('#agm_agendamento_confirmado_c').prop('checked', false);
                $('#agm_atendimento_particular_c').prop('checked', false);
            });
            
            $('#myModalEncaixe_off').on('hidden.bs.modal', function () {
                $('#id_beneficiarios_e').val('');
                $('#agm_paciente_data_e').val('');
                $('#agm_paciente_hora_e').val('');
                $('#select2-chosen-2').html('');
                $('#agm_paciente_nome_e').val('');
                $('#agm_paciente_email_e').val('');
                $('#agm_paciente_telefone_e').val('');
                $('#agm_paciente_telefone_fixo_e').val('');
                $('#id_operadoras_e').val('');
                $('#agm_observacao_e').val('');
                $('#agm_primeira_consulta_e').prop('checked', false);
            });
            
            $('#myModalConfirmar').on('show.bs.modal', function () {
                // Controla a exibição dos campos do convênio
                setTimeout(function(){
                    mostraCamposConvenio();
                },50);
                $('#select2-chosen-3').html($('#agm_paciente_nome_c').val());
            });
            
            var hoje = new Date(); // Data de Hoje
            var dd = hoje.getDate();
            var mm = hoje.getMonth() + 1; //Janeiro é 0!
            var yyyy = hoje.getFullYear();
            var ListofDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
            var date; //DATA DO CALENDARIO DE CONSULTA
            var id_horario; //HORA SEM OS DOIS PONTOS ':'
            var hora, json_temp, json_bloq;
            var vetor_usuarios = [];
            var id_agendas = 243;
            var HTTPS_ROOT = 'https://app.4clinics.software/';
            
            /*-----------------------------------------------------------------------
            | Implementado para a máscara aceitar 8 e 9 dígitos
            | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
            | Em : 19/05/2016
            |----------------------------------------------------------------------*/
            $('#agm_paciente_telefone, #agm_paciente_telefone_fixo, #agm_paciente_telefone_c, #agm_paciente_telefone_fixo_c, #agm_paciente_telefone_e, #agm_paciente_telefone_fixo_e').blur(function(){
            
                if($(this).val().length == 10){
                    $(this).mask('(99) 9999-9999?9');
                }else if($(this).val().length == 11){
                    $(this).mask('(99) 99999-9999');
                }
            });    
            if($('#agm_paciente_telefone_c').val().length == 10){
                $('#agm_paciente_telefone_c').mask('(99) 9999-9999?9');
            }else if($('#agm_paciente_telefone_c').val().length == 11){
                $('#agm_paciente_telefone_c').mask('(99) 99999-9999');
            }
            $('#agm_paciente_telefone_fixo_c').mask('(99) 9999-9999');
            
            $('#inserir_encaixe').click(function () {
                var dd = checkDd($("#datepicker").datepicker('getDate').getDate());
                var mm = checkMm($("#datepicker").datepicker('getDate').getMonth() + 1);
                var yyyy = $("#datepicker").datepicker('getDate').getFullYear();
                var data = dd+'/'+mm+'/'+yyyy;
            
                $('#agm_paciente_data_e').val(data);
            });
            
            $('#bt_modal_ok').click(function () {
                var tipo_agendamento = $('#id_tipo_agendamento').val();
                /*-----------------------------------------------------------------------
                | Alterado para salvar apenas o nome
                | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                | Em : 21/03/2016
                |----------------------------------------------------------------------*/
                var nome_c = $('#agm_paciente_nome').val();
                var indd = nome_c.indexOf('-');
                if(indd > 0){
                    var nome = nome_c.substring(0, (indd - 1));
                }else{
                    var nome = nome_c;
                }
                var email = $('#agm_paciente_email').val();
                var celular = $('#agm_paciente_telefone').val();
                var telefone = $('#agm_paciente_telefone_fixo').val();        
                var id_operadoras = $('#id_operadoras').val();
                var observacao = $('#agm_observacao').val();
                var primeira_consulta = $('#agm_primeira_consulta').prop('checked');
                var id_beneficiarios = $('#id_beneficiarios').val();        
                var id_modal = $('#hora_modal').val();
                var continuar = true;
            
                var dd = checkDd($("#datepicker").datepicker('getDate').getDate());
                var mm = checkMm($("#datepicker").datepicker('getDate').getMonth() + 1);
                var yyyy = $("#datepicker").datepicker('getDate').getFullYear();
            
                if ((nome == '') || (celular == '') || (tipo_agendamento == '0') || (id_operadoras == '') ){
                    continuar = false;
                }
            
                if(continuar){
                    $.post('https://app.4clinics.software/agenda/salvar_agenda_marcacao',
                        {id_agendas: id_agendas,
                            agm_data: date,
                            agm_hora: hora,
                            id_tipo_agendamento: tipo_agendamento,
                            agm_paciente_nome: nome,
                            agm_paciente_email: email,
                            agm_paciente_telefone: celular,
                            agm_paciente_telefone_fixo: telefone,
                            id_operadoras: id_operadoras,
                            agm_observacao: observacao,                    
                            agm_primeira_consulta: primeira_consulta,
                            id_beneficiarios: id_beneficiarios
                        },
                        function (data) {
                            if (!data) {
                                $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Agendamento:</h4>');
                                $('#myModalGeral .modal-body').html('<p>Agendamento realizado com sucesso!</p>');
                                $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="recarregar(\''+dd+'/'+mm+'/'+yyyy+'\')">OK</button>');
                                $('#btnModalGeral').trigger('click');
                            }
                        });
                }else{
                    $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Agendamento:</h4>');
                    $('#myModalGeral .modal-body').html('<p>É necessário informar pelo menos, os campos: <strong>Tipo do Agendamento, Convênio/Plano de Saúde, Nome do Paciente e Telefone Celular</strong>!</p>');
                    $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="$(\'#'+id_modal+'\').trigger(\'click\');">OK</button>');
                    $('#btnModalGeral').trigger('click');
                }
            });
            
            /*-----------------------------------------------------------------------
            | Para mostrar a hora final do encaixe
            | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
            | Em : 24/06/2016
            |----------------------------------------------------------------------*/
            function bloco_hora_final_encaixe() {
                if(! $('#hora_final_encaixe_bloco').is(':visible')){
                    $('#hora_final_encaixe_bloco').show();
                }else{
                    $('#hora_final_encaixe_bloco').hide();
                }
            }
            
            function Modal(element, id) {
                var dd = checkDd($("#datepicker").datepicker('getDate').getDate());
                var mm = checkMm($("#datepicker").datepicker('getDate').getMonth() + 1);
                var yyyy = $("#datepicker").datepicker('getDate').getFullYear();
                var data_agendamento = dd+'/'+mm+'/'+yyyy;
                
                //console.log(data_agendamento);
                
                var array_hora;
                id_horario = id;
            
                if (id_horario.length < 4) {
                    id_horario = '0' + id_horario;
                }
                array_hora = id_horario.split('');
                document.getElementById('modal-title').innerHTML = hora = (array_hora[0] + array_hora[1] + ':' + array_hora[2] + array_hora[3]);
                document.getElementById('hora_modal').value = (id);
                document.getElementById('data-modal').innerHTML = (data_agendamento);   
            }
            
            function ModalConfirmar(element, id) {
                var dd = checkDd($("#datepicker").datepicker('getDate').getDate());
                var mm = checkMm($("#datepicker").datepicker('getDate').getMonth() + 1);
                var yyyy = $("#datepicker").datepicker('getDate').getFullYear();
                var data_agendamento = dd+'/'+mm+'/'+yyyy;
                
                //console.log(data_agendamento);
                
                var array_hora;
                id_horario = id;
            
                if (id_horario.length < 4) {
                    id_horario = '0' + id_horario;
                }
                array_hora = id_horario.split('');
                document.getElementById('modal-title_c').innerHTML = hora = (array_hora[0] + array_hora[1] + ':' + array_hora[2] + array_hora[3]);
                document.getElementById('data-modal_c').innerHTML = (data_agendamento); 
                
                /*-----------------------------------------------------------------------
                | Inserido para enviar as informações a confirmar
                | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                | Em : 17/03/2016
                |----------------------------------------------------------------------*/
                var id_horario_recebido = $(element).attr('id');
                var id_beneficiario_recebido = $(element).children().eq(1).children().attr('id');
            
                $('#bt_modal_ok_cp').attr('onclick','confirmar_presenca(\''+id_beneficiario_recebido+'\',\''+id_horario_recebido+'\')');
            
                id_agendas_marcacoes_c = $(element).children().eq(1).children().attr('id_agendas_marcacoes');
                id_beneficiarios_c = $(element).children().eq(1).children().attr('id_beneficiarios');
                id_operadoras_c = $(element).children().eq(1).children().attr('id_operadoras');
                id_tipo_agendamento_c = $(element).children().eq(1).children().attr('id_tipo_agendamento');
                agm_paciente_nome_c = $(element).children().eq(1).children().attr('agm_paciente_nome'); //PEGA O NOME DO PACIENTE
                ben_numero_carteira_c = $(element).children().eq(1).children().attr('ben_numero_carteira');
                ben_validade_carteira_c = $(element).children().eq(1).children().attr('ben_validade_carteira');
                agm_paciente_telefone_c = $(element).children().eq(1).children().attr('celular');
                agm_paciente_telefone_fixo_c = $(element).children().eq(1).children().attr('telefone');
                agm_paciente_email_c = $(element).children().eq(1).children().attr('email');    
                agm_observacao_c = $(element).children().eq(1).children().attr('observacao');    
                agm_primeira_consulta_c = $(element).children().eq(1).children();
                agm_agendamento_confirmado_c = $(element).children().eq(1).children();
            
                if (id_operadoras_c.length > 0) {
                    $('#id_operadoras_c').val(id_operadoras_c);
                    $('#id_operadoras_cadastrado').val(id_operadoras_c);
                }
            
                if (id_tipo_agendamento_c.length > 0) $('#id_tipo_agendamento_c').val(id_tipo_agendamento_c);
                if (agm_paciente_nome_c.length > 1) $('#agm_paciente_nome_c').val(agm_paciente_nome_c);
                if (agm_paciente_email_c.length > 1) $('#agm_paciente_email_c').val(agm_paciente_email_c);
                
                if (id_operadoras_c != '0') {
                    if (ben_numero_carteira_c.length > 0) {
                        if(ben_numero_carteira_c === 'null'){
                            $('#ben_numero_carteira_c').val();
                        }else{
                            $('#ben_numero_carteira_c').val(ben_numero_carteira_c);
                        }       
                    }
                    if (ben_validade_carteira_c.length > 0) {
                        if ((ben_validade_carteira_c !== 'null') && (validatedate(ben_validade_carteira_c))) {
                            $('#ben_validade_carteira_c').val(ben_validade_carteira_c);
                        }else{
                            $('#ben_validade_carteira_c').val('');
                        }        
                    }
                } 
            
                if (agm_paciente_telefone_c.length > 0) {
                    if (agm_paciente_telefone_c === 'null') {
                        $('#agm_paciente_telefone_c').val();
                    }else{
                        $('#agm_paciente_telefone_c').val(agm_paciente_telefone_c);
                    }
                }
            
                if (agm_paciente_telefone_fixo_c.length > 0) {
                    if (agm_paciente_telefone_fixo_c === 'null') {
                        $('#agm_paciente_telefone_fixo_c').val();
                    }else{
                        $('#agm_paciente_telefone_fixo_c').val(agm_paciente_telefone_fixo_c);
                    }
                }
                
                
                if (agm_observacao_c.length > 0) {
                    if (agm_observacao_c !== 'null') {
                        $('#agm_observacao_c').val(agm_observacao_c);
                    }else{
                        $('#agm_observacao_c').val();
                    }
                }
                
                if (id_agendas_marcacoes_c.length > 0) $('#id_agendas_marcacoes_c').val(id_agendas_marcacoes_c);
                if (id_beneficiarios_c.length > 0) $('#id_beneficiarios_c').val(id_beneficiarios_c);
            
                $('#hora_modal_c').val(id);
            
                if(agm_primeira_consulta_c.size() > 0){
                    if(agm_primeira_consulta_c.parent().parent().children().eq(3).children().hasClass('consulta')){
                        $('#agm_primeira_consulta_c').prop('checked', true)
                    }else{
                        $('#agm_primeira_consulta_c').prop('disabled', true);
                    }
                }
            
                if(agm_agendamento_confirmado_c.size() > 0){
                    if(agm_agendamento_confirmado_c.parent().parent().children().eq(3).children().hasClass('confirmado')){
                        $('#agm_agendamento_confirmado_c').prop('checked', true)
                    }
                }
            }
            
            
            function ModalAtendimento(element, id) {
                var tr_elemento = $(element);
                var tr_id = $('#'+id).attr('id');
                var id_operadoras = $(element).children().eq(1).children().attr('id_operadoras');
            
            if (id > 0) {
            //console.log('json: '+JSON.parse($(element).children().eq(1).children().attr('json')));
            var json_ = JSON.parse($(element).children().eq(1).children().attr('json'));
            
            $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Atendimento:</h4>');
            $('#myModalGeral .modal-body').html('<p>Após o registro do atendimento de um agendamento é possível realizar o preenchimento de uma guia (<strong>atendimento via convênios</strong>) ou efetuar o faturamento do atendimento (<strong>atendimento particular</strong>).<br><br>Deseja preencher uma guia ou executar o faturamento para este atendimento?</p>');
            
            var html = '<span class="centralizado">'+
            '<button type="button" class="btn btn-default atendimento_btn" data-dismiss="modal">Apenas Fechar</button><br>';
            
            if (json_.agm_paciente_atendido != 'S') {
            html = html +
            '<button type="button" class="btn btn-primary atendimento_btn" onclick="registrar_atendimento(\''+tr_id+'\')" data-dismiss="modal">Registrar atendimento</button><br>';
            }
            
            if ((id_operadoras > 0) && (json_.agm_paciente_atendido == 'S') && (json_.agm_guia_preenchida != 'S')) {      
            html = html +
            '<!--button type="button" class="btn btn-default atendimento_btn" onclick="guia_sadt(\''+tr_id+'\')" data-dismiss="modal">Preencher Guia de SADT</button><br-->'+
            '<button type="button" class="btn btn-default atendimento_btn" onclick="guia_consulta(\''+tr_id+'\')" data-dismiss="modal">Preencher Guia de Consulta</button>'+
            '</span>';
            }
            
            if ((id_operadoras == 0) && (json_.agm_faturado != 'S') && (json_.agm_paciente_atendido == 'S')) {
            html = html +
            '<button type="button" class="btn btn-success atendimento_btn" onclick="faturamento_consulta(\''+tr_id+'\')" data-dismiss="modal">Faturar Atendimento</button>'+ 
            '</span>';
            }
            
            $('#myModalGeral .modal-footer').html(html);
            }
            }
            
            function ModalBloqueado(element, id) {
                var id_agendas_marcacoes_b = $(element).children().eq(1).children().attr('id_agendas_marcacoes');
                json_bloq = $(element).children().eq(1).children().attr('json');
            
                var dd = checkDd($("#datepicker").datepicker('getDate').getDate());
                var mm = checkMm($("#datepicker").datepicker('getDate').getMonth() + 1);
                var yyyy = $("#datepicker").datepicker('getDate').getFullYear();
            
                $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Bloqueio:</h4>');
                $('#myModalGeral .modal-body').html('<p>Este horario encontra-se bloqueado!<br><br>Para registrar um agendamento neste horário faça seu desbloqueio.</p>');
            
                var html = '<span class="centralizado">'+
                '<button type="button" class="btn btn-primary atendimento_btn" data-dismiss="modal">Manter bloqueado</button>'+
                '<button type="button" class="btn btn-default atendimento_btn" onclick="desbloquear_horario(\''+id_agendas_marcacoes_b+'\')" data-dismiss="modal">Desbloquear horario</button>'+
                '</spam>';
            
                $('#myModalGeral .modal-footer').html(html);
            }
            
            function desbloquear_horario(id){
                var json = JSON.parse(json_bloq);
            
                /*-----------------------------------------------------------------------
                | Para verificar se pertence a um agendamento,
                | se pertence a um agendamento será uma array
                | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                | Em : 17/06/2016
                |----------------------------------------------------------------------*/
                if(json.ids_horario_extendido instanceof Array){
                    if(id != json.ids_horario_extendido[0]){
                        $('#myModalGeral2 .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Desbloqueio:</h4>');
                        $('#myModalGeral2 .modal-body').html('<p>Esse bloqueio pertence a um agendamento com horário extendido.</p><p>Por favor exclua os bloqueios na ordem do último para o primeiro ou clique no agendamento para excluir todos os registros.</p>');
                    
                        var html = '<span class="centralizado">'+
                        '<button type="button" class="btn btn-default atendimento_btn" data-dismiss="modal">OK</button>'+
                        '</spam>';
            
                        $('#myModalGeral2 .modal-footer').html(html);
                        $('#btnModalGeral2').trigger('click');
                    }else{
                        $('#myModalGeral2 .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Desbloqueio:</h4>');
                        $('#myModalGeral2 .modal-body').html('<p>Confirma o desbloqueio deste horario?</p>');
                    
                        var html = '<span class="centralizado">'+
                        '<button type="button" class="btn btn-primary atendimento_btn" data-dismiss="modal" onclick="desbloquear_horario_continuacao('+id+')">Desbloquear horario</button>'+
                        '<button type="button" class="btn btn-default atendimento_btn" data-dismiss="modal">Manter bloqueado</button>'+
                        '</spam>';
            
                        $('#myModalGeral2 .modal-footer').html(html);
                        $('#btnModalGeral2').trigger('click');    
                    }
                }else{
                    /*-----------------------------------------------------------------------
                    | Não pertence a um agendamento, é um bloqueio simples
                    | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                    | Em : 17/06/2016
                    |----------------------------------------------------------------------*/
                    $('#myModalGeral2 .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Desbloqueio:</h4>');
                    $('#myModalGeral2 .modal-body').html('<p>Confirma o desbloqueio deste horario?</p>');
                
                    var html = '<span class="centralizado">'+
                    '<button type="button" class="btn btn-primary atendimento_btn" data-dismiss="modal" onclick="desbloquear_horario_continuacao('+id+')">Desbloquear horario</button>'+
                    '<button type="button" class="btn btn-default atendimento_btn" data-dismiss="modal">Manter bloqueado</button>'+
                    '</spam>';
            
                    $('#myModalGeral2 .modal-footer').html(html);
                    $('#btnModalGeral2').trigger('click'); 
                }
            }
            
            function desbloquear_horario_continuacao(id){
            
                var dd = checkDd($("#datepicker").datepicker('getDate').getDate());
                var mm = checkMm($("#datepicker").datepicker('getDate').getMonth() + 1);
                var yyyy = $("#datepicker").datepicker('getDate').getFullYear();
            
                $.post('https://app.4clinics.software/agenda/deletar_bloqueio',
                    {id_agendas_marcacoes: id},
                    function (data) {
                        if (!data) {
            
                            $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Desbloqueio:</h4>');
                            $('#myModalGeral .modal-body').html('<p>Bloqueio removido com sucesso!</p>');
                            $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="recarregar(\''+dd+'/'+mm+'/'+yyyy+'\')">OK</button>');
                            $('#btnModalGeral').trigger('click');
                        }
                    });
            }
            
            function registrar_atendimento(id){    
                id_agendas_marcacoes_c = $('#'+id).children().eq(1).children().attr('id_agendas_marcacoes');
            
                var dd = checkDd($("#datepicker").datepicker('getDate').getDate());
                var mm = checkMm($("#datepicker").datepicker('getDate').getMonth() + 1);
                var yyyy = $("#datepicker").datepicker('getDate').getFullYear();
            
                $.post('https://app.4clinics.software/agenda/registrar_atendimento',
                    {id_agendas_marcacoes: id_agendas_marcacoes_c,
                        id_agendas: id_agendas
                    },
                    function (data) {
                        if (!data) {
                            $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Registro de Atendimento:</h4>');
                            $('#myModalGeral .modal-body').html('<p>Atendimento registrado com sucesso!</p>');
                            $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="recarregar(\''+dd+'/'+mm+'/'+yyyy+'\')">OK</button>');
                            $('#btnModalGeral').trigger('click');
                        }
                    }
                );
            }
            
            function guia_sadt(id){
                atd_numero_atendimento = $('#'+id).children().eq(1).children().attr('atd_numero_atendimento');
                id_agendas_marcacoes = $('#'+id).children().eq(1).children().attr('id_agendas_marcacoes');
            
                window.location.href = 'https://app.4clinics.software/guias/sp_sadt/agenda_marcacao/'+id_agendas_marcacoes+'/atendimento/'+atd_numero_atendimento+'/agenda/'+id_agendas;
            }
            
            function guia_gto(id){
                atd_numero_atendimento = $('#'+id).children().eq(1).children().attr('atd_numero_atendimento');
                id_agendas_marcacoes = $('#'+id).children().eq(1).children().attr('id_agendas_marcacoes');
            
                window.location.href = 'https://app.4clinics.software/guias/tratamento_odontologico/agenda_marcacao/'+id_agendas_marcacoes+'/atendimento/'+atd_numero_atendimento+'/agenda/'+id_agendas;
            }
            
            function guia_consulta(id){
                atd_numero_atendimento = $('#'+id).children().eq(1).children().attr('atd_numero_atendimento');
                id_agendas_marcacoes = $('#'+id).children().eq(1).children().attr('id_agendas_marcacoes');
            
                window.location.href = 'https://app.4clinics.software/guias/consultas/agenda_marcacao/'+id_agendas_marcacoes+'/atendimento/'+atd_numero_atendimento+'/agenda/'+id_agendas;
            }
            
            function dataAtualFormatada(){
                var data = new Date();
                var dia = data.getDate();
                if (dia.toString().length == 1)
                  dia = "0"+dia;
                var mes = data.getMonth()+1;
                if (mes.toString().length == 1)
                  mes = "0"+mes;
                var ano = data.getFullYear();  
                return dia+"/"+mes+"/"+ano;
            }
            
            var flag = false;
            var currentDate; //Data Atual
            var dayOfWeek; //DIA DA SEMANA Em Numero
            var dayOfWeekName; //DIA DA SEMANA EM TEXTO 
            var date_object = new Date() //Pega a Data Como Objeto
            var data_grade_horario = false;
            var encaixes = false;
            var data_agenda_config = false;
            
                $('#ben_validade_carteira_c').datepicker({
                showButtonPanel: true,
                changeMonth: true,
                changeYear: true,
                currentText: 'Hoje',
                closeText: 'Fechar',
                dateFormat: 'dd/mm/yy',
                dayNames: ['Domingo', 'Segunda', 'Terça', 'Quarta', 'Quinta', 'Sexta', 'Sábado', 'Domingo'],
                dayNamesMin: ['D', 'S', 'T', 'Q', 'Q', 'S', 'S', 'D'],
                dayNamesShort: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                monthNames: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
                monthNamesShort: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez']
            });
            
            $("#datepicker").datepicker({
                showButtonPanel: true,
                changeMonth: true,
                changeYear: true,
                currentText: 'Hoje',
                closeText: 'Fechar',
                dateFormat: 'dd/mm/yy',
                dayNames: ['Domingo', 'Segunda', 'Terça', 'Quarta', 'Quinta', 'Sexta', 'Sábado', 'Domingo'],
                dayNamesMin: ['D', 'S', 'T', 'Q', 'Q', 'S', 'S', 'D'],
                dayNamesShort: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                monthNames: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
                monthNamesShort: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],        
                inline: true,
                //beforeShowDay: $.datepicker.noWeekends,
                onSelect: function (dateText, inst) {
                    dd = $("#datepicker").datepicker('getDate').getDate();
                    mm = $("#datepicker").datepicker('getDate').getMonth() + 1; //Janeiro é 0!
                    yyyy = $("#datepicker").datepicker('getDate').getFullYear();
                    data_p = yyyy+'-'+checkMm(mm)+'-'+checkDd(dd);
                    obter_dados_post(data_p);
                }
            });
            
            setTimeout(function(){
                dd_inicial = $("#datepicker").datepicker('getDate').getDate();
                mm_inicial = $("#datepicker").datepicker('getDate').getMonth() + 1; //Janeiro é 0!
                yyyy_inicial = $("#datepicker").datepicker('getDate').getFullYear();
                data_inicial = yyyy_inicial+'-'+checkMm(mm_inicial)+'-'+checkDd(dd_inicial);
                obter_dados_post(data_inicial);
            },50);
            
            function mostrar_encaixe_reagendar() {
                $('#reagenda_encaixe_horario').toggle();
            }
            
            function obter_dados_post_r(data) {
                var json = false;
                $.ajax({
                    type: "POST",
                    url: 'https://app.4clinics.software/agenda/obter_horarios_livres',
                    data: { 
                        id_agendas: id_agendas,
                        data: data
                    },
                })
                .done(function(data){
                    receber_dados_r(data);
                });
            }
            
            function receber_dados_r(dados) {
                var json = JSON.parse(dados);
                var html = '<select id="agm_paciente_hora_r" name="agm_paciente_hora_r" class="form-control input-sm">';
            
                var count = Object.keys(json).length;
            
                if(count > 0){
                    for(var i in json){
                        html += '<option value="'+json[i]+'">'+json[i]+'</option>';
                    }
                }else{
                    html += '<option value="0">Nenhum horario disponível</option>';
                }
            
                html += '</select>';
                html += '&nbsp;<span>Reagendar como encaixe</span> <input type="checkbox" id="mostrar_encaixe_reagendar_check" onclick="mostrar_encaixe_reagendar()">';
                html += '<br>&nbsp;<span id="reagenda_encaixe_horario" style="display: none;">Informe o horario: <input type="text" id="agm_paciente_encaixe_hora_r" class="form-control input-sm" data-mask="99:99"></span>';
            
                $('#agm_paciente_hora_r').parent().html(html);
            }
            
            function obter_dados_post(data) {
                var json = false;
                $.ajax({
                    type: "POST",
                    url: 'https://app.4clinics.software/agenda/carregar_agenda_dia',
                    data: { 
                        id_agendas: id_agendas,
                        data: data
                    },
                })
                .done(function(data){
                    receber_dados(data);
                });
            }
            
            function receber_dados(dados) {
                if(dados){
                    json = JSON.parse(dados);
                    Monta_Agenda(json.data_grade_horario, json.data_encaixes, json.data_agenda_config);
                    //alert("Cell index is: " + json.data_agenda_config);
                }else{
                    $('#tbody-table-hours').html('');
            
                    Monta_Agenda(data_grade_horario, encaixes, data_agenda_config);
            
                    date = ($("#datepicker").datepicker().val());
                    dayOfWeek = ($("#datepicker").datepicker('getDate')).getUTCDay();
                    dayOfWeekName = (DayOfWeekName(dayOfWeek));
            
                    $('#data_selecionada').html(dayOfWeekName + ', ' + date);
                }
            }
            
            function Monta_Agenda(data_grade_horario, encaixes, data_agenda_config) {
                date = ($("#datepicker").datepicker().val()); //PEGA A DATA DO DATAPIKER (DIA/MES/ANO)
                dateElement = ($("#datepicker").datepicker('getDate')); //PEGA A DATA GLOBAL DATA ( semana , dia mes ano , hora)
                dayOfWeek = dateElement.getUTCDay(); //PEGA SOMENTE DIA DA SEMANA (O DATA PICKER INICIA SE EM ZERO, PRECISEI SOMAR MAIS 1)
                dayOfWeekName = (DayOfWeekName(dayOfWeek));        
            
                data_do_dia_selecionado = date;
                document.getElementById('data_selecionada').innerHTML = (dayOfWeekName + ', ' + date);
                BuildTableHours(dayOfWeek, data_do_dia_selecionado, data_grade_horario, encaixes, data_agenda_config);        
            }
            
            function BuildTableHours(dayOfWeek, data, data_grade_horario, encaixes, data_agenda_config) {
                var id_agendas_marcacoes = '';
                var id_beneficiarios = '';
                var id_operadoras = '';
                var id_tipo_agendamento = '';
                var agm_paciente_nome = '';
                var ben_numero_carteira = '';
                var ben_validade_carteira = '';
                var celular = '';
                var telefone = '';
                var agm_observacao = '';
            
                var agm_primeira_consulta = '';
                var agm_agendamento_confirmado = '';
            var status_agendamento = '';
                
                var agm_bloqueio_descricao = '';
                var dia_mes_ano_grade_horario;
                var data_hora;
                var horario = data_agenda_config;
                horarios_semana = horario[dayOfWeek]['agc_horarios'].split(',');
                var html = new Array();
                var controle = 0;
            
                $('#tbody-table-hours').children().remove();
            
                for (var i = 0; i < horarios_semana.length; i++) {
                    horarios_semana[i] = horarios_semana[i].replace("'", ''); // RETIRA AS ASPAS SIMPLES DAS STRINGS
            
                    if (horarios_semana[i].length == 4) {
                        horarios_semana[i] = '0' + horarios_semana[i];
                    }
            
                    if(encaixes){
                        for (var k = 0; k < encaixes.length; k++) {
                            data_hora = TrataDataBr(encaixes[k]['agm_data_hora_marcacao']);
                            if (data_hora[0] == data) {
                                if (data_hora[1] != horarios_semana[i]) {
                                    var dados_final_e = JSON.stringify(encaixes[k]);
                                
                                    hora1 = parseInt(data_hora[1].replace(':', ''));
                                    id_horas_sem_ponto = data_hora[1].replace(':', '');
                                    id_horas_sem_ponto = (id_horas_sem_ponto < 1000)? id_horas_sem_ponto.substring(1) : id_horas_sem_ponto;
            
                                    id_agendas_marcacoes = encaixes[k]['id_agendas_marcacoes'];
                                    id_beneficiarios = encaixes[k]['id_beneficiarios_m'];
                                    id_operadoras = encaixes[k]['id_operadoras_m'];
                                    id_tipo_agendamento = encaixes[k]['id_tipo_agendamento'];
                                    agm_paciente_nome = encaixes[k]['agm_paciente_nome'].toUpperCase();
                                    ope_nome = (encaixes[k]['ope_nome'] == null)? ' (PARTICULAR)' : ' ('+encaixes[k]['ope_nome']+')';
                                    agm_paciente_email = encaixes[k]['agm_paciente_email'];
                                    ben_numero_carteira = encaixes[k]['ben_numero_carteira'];
                                    ben_validade_carteira = encaixes[k]['ben_validade_carteira'];
                                    celular = encaixes[k]['agm_paciente_telefone'];
                                    telefone = encaixes[k]['agm_paciente_telefone_fixo'];
                                    agm_observacao = encaixes[k]['agm_observacao'];
                                    atd_numero_atendimento = encaixes[k]['atd_numero_atendimento'];
            
                                    agm_primeira_consulta = (encaixes[k]['agm_primeira_consulta'] == 'S')? 'P' : '';
                                    agm_agendamento_confirmado = (encaixes[k]['agm_agendamento_confirmado'] == 'S')? 'C' : '';
                                    
                                    if (encaixes[k]['agm_faturado'] == 'S') {
                                        status_agendamento = 'texto_faturado';
                                    } else if (encaixes[k]['agm_guia_preenchida'] == 'S') {
                                        status_agendamento = 'azul';
                                    } else if (encaixes[k]['agm_paciente_atendido'] == 'S') {
                                        status_agendamento = 'verde';
                                    } else if (encaixes[k]['agm_paciente_na_recepcao'] == 'S') {
                                        status_agendamento = 'vermelho';
                                    } else if (encaixes[k]['agm_paciente_faltou'] == 'S') {
                                        status_agendamento = 'laranjado';
                                    } else if (encaixes[k]['agm_encaixe'] == 'S') { 
                            status_agendamento = 'amarelo';
                        } else {
                            status_agendamento = '';
                        }
                        
                        if (agm_paciente_nome != '') {
                            html[id_horas_sem_ponto] = '<tr id="' + id_horas_sem_ponto + '" class="' + data_hora[1] + '"><td>' + data_hora[1] + '</td><td data-toggle="modal" data-target="#myModalConfirmar" onclick="ModalConfirmar(this.parentNode,this.parentNode.id)"><span class="'+status_agendamento+'" id="nome_paciente'+controle+'" id_agendas_marcacoes="'+id_agendas_marcacoes+'" id_beneficiarios="'+id_beneficiarios+'" id_operadoras="'+id_operadoras+'" ope_nome="'+ope_nome+'" id_tipo_agendamento="'+id_tipo_agendamento+'" ben_numero_carteira="'+ben_numero_carteira+'" ben_validade_carteira="'+ben_validade_carteira+'" celular="'+celular+'" telefone="'+telefone+'" email="'+agm_paciente_email+'" observacao="'+agm_observacao+'" atd_numero_atendimento="'+atd_numero_atendimento+'" agm_paciente_nome="'+agm_paciente_nome+'" json=\''+dados_final_e+'\'>' + agm_paciente_nome + ope_nome +'</span></td><td id="buttonProntuario"></td>';
                            if (agm_primeira_consulta != '' && agm_agendamento_confirmado != '') {
                                html[id_horas_sem_ponto] = html[id_horas_sem_ponto] + '<td><span class="consulta">' + agm_primeira_consulta + '</span><span class="confirmado">' + agm_agendamento_confirmado + '</span></td></tr>';
                            } else if (agm_primeira_consulta != '') {
                                html[id_horas_sem_ponto] = html[id_horas_sem_ponto] + '<td><span class="consulta">' + agm_primeira_consulta + '</span></td></tr>';
                            } else if (agm_agendamento_confirmado != '') {
                                html[id_horas_sem_ponto] = html[id_horas_sem_ponto] + '<td><span class="confirmado">' + agm_agendamento_confirmado + '</span></td></tr>';
                            } else {
                                html[id_horas_sem_ponto] = html[id_horas_sem_ponto] + '<td></td></tr>';
                            }
                        } else {
                                        html[id_horas_sem_ponto] = '<tr data-toggle="modal" data-target="#myModal" id="' + id_horas_sem_ponto + '" class="' + data_hora[1] + '" onclick="Modal(this,this.id)"> <td>' + 'e. ' + data_hora[1] + '</td> <td><span id="nome_paciente'+i+'"></span></td><td></td><td></td></tr>';
                                    }
                        
                                    encaixes.splice(k, 1);
                                    controle++;
                                }
                            }
                        }
                    }
            
                    id_horas_sem_ponto = horarios_semana[i].replace(':', ''); //HORA COMO  ID
                    id_horas_sem_ponto = (id_horas_sem_ponto < 1000)? id_horas_sem_ponto.substring(1) : id_horas_sem_ponto;
            
                    //LIMPA VARIAVEIS
                    id_agendas_marcacoes = '';
                    id_beneficiarios = '';
                    id_operadoras = '';
                    id_tipo_agendamento = '';
                    agm_paciente_nome = '';
                    ope_nome = '';
                    ben_numero_carteira = '';
                    ben_validade_carteira = '';
                    celular = '';
                    telefone = '';
                    agm_observacao = '';
            
                    agm_primeira_consulta = '';
                    agm_agendamento_confirmado = '';
                    status_agendamento = '';
            
                    if(data_grade_horario){
                        for (var j = 0; j < data_grade_horario.length; j++) {
                            data_hora = TrataDataBr(data_grade_horario[j]['agm_data_hora_marcacao']);
                            if (data_hora[0] == data) {
                                if (data_hora[1] == horarios_semana[i]) {
                                    var dados_final_n = JSON.stringify(data_grade_horario[j]);
            
                                    id_agendas_marcacoes = data_grade_horario[j]['id_agendas_marcacoes'];
                                    id_beneficiarios = data_grade_horario[j]['id_beneficiarios_m'];
                                    id_operadoras = data_grade_horario[j]['id_operadoras_m'];
                                    id_tipo_agendamento = data_grade_horario[j]['id_tipo_agendamento'];
                                    agm_paciente_nome = data_grade_horario[j]['agm_paciente_nome'].toUpperCase();
                                    ope_nome = (data_grade_horario[j]['ope_nome'] == null)? ' (PARTICULAR)' : ' ('+data_grade_horario[j]['ope_nome']+')';
                                    agm_paciente_email = data_grade_horario[j]['agm_paciente_email'];
                                    ben_numero_carteira = data_grade_horario[j]['ben_numero_carteira'];
                                    ben_validade_carteira = data_grade_horario[j]['ben_validade_carteira'];
                                    celular = data_grade_horario[j]['agm_paciente_telefone'];
                                    telefone = data_grade_horario[j]['agm_paciente_telefone_fixo'];
                                    agm_observacao = ((data_grade_horario[j]['agm_observacao'] === null) || (data_grade_horario[j]['agm_observacao'] === 'null'))? '' : data_grade_horario[j]['agm_observacao'];
                                    atd_numero_atendimento = data_grade_horario[j]['atd_numero_atendimento'];
            
                                    agm_primeira_consulta = (data_grade_horario[j]['agm_primeira_consulta'] == 'S')? 'P' : '';
                                    agm_agendamento_confirmado = (data_grade_horario[j]['agm_agendamento_confirmado'] == 'S')? 'C' : '';
            
                                    if (data_grade_horario[j]['agm_faturado'] == 'S') {
                                        status_agendamento = 'texto_faturado';
                                    } else if (data_grade_horario[j]['agm_guia_preenchida'] == 'S') {
                                        status_agendamento = 'azul';
                                    } else if (data_grade_horario[j]['agm_paciente_atendido'] == 'S') {
                                        status_agendamento = 'verde';
                                    } else if (data_grade_horario[j]['agm_paciente_na_recepcao'] == 'S') {
                                        status_agendamento = 'vermelho';
                                    } else if (data_grade_horario[j]['agm_paciente_faltou'] == 'S') {
                                        status_agendamento = 'laranjado';
                                    } else if (data_grade_horario[j]['agm_encaixe'] == 'S') { 
                            status_agendamento = 'amarelo';
                        } else {
                            status_agendamento = '';
                        }
                        
                                    agm_bloqueio_descricao = ((data_grade_horario[j]['agm_bloqueio_descricao'] === '') || (data_grade_horario[j]['agm_bloqueio_descricao'] === 'null') || (data_grade_horario[j]['agm_bloqueio_descricao'] === null) )? '' : 'bloqueado';
                                }
                            }
                        }
                    }
                    
                    if (horarios_semana[i] != "") {
                        if (agm_paciente_nome != '') {
                html[id_horas_sem_ponto] = '<tr id="' + id_horas_sem_ponto + '" class="' + horarios_semana[i] + '"><td>' + horarios_semana[i] + '</td> <td data-toggle="modal" data-target="#myModalConfirmar" onclick="ModalConfirmar(this.parentNode,this.parentNode.id)"><span class="'+status_agendamento+agm_bloqueio_descricao+'" id="nome_paciente'+controle+'" id_agendas_marcacoes="'+id_agendas_marcacoes+'" id_beneficiarios="'+id_beneficiarios+'" id_operadoras="'+id_operadoras+'" ope_nome="'+ope_nome+'" id_tipo_agendamento="'+id_tipo_agendamento+'" ben_numero_carteira="'+ben_numero_carteira+'" ben_validade_carteira="'+ben_validade_carteira+'" celular="'+celular+'" telefone="'+telefone+'" email="'+agm_paciente_email+'" observacao="'+agm_observacao+'" atd_numero_atendimento="'+atd_numero_atendimento+'" agm_paciente_nome="'+agm_paciente_nome+'" json=\''+dados_final_n+'\'>' + agm_paciente_nome;
                if(agm_primeira_consulta != '' && agm_agendamento_confirmado != '') {
                    html[id_horas_sem_ponto] = html[id_horas_sem_ponto] + ope_nome +'</span></td><td id="buttonProntuario"></td><td><span class="consulta">' + agm_primeira_consulta + '</span><span class="confirmado">' + agm_agendamento_confirmado + '</span></td></tr>';
                } else if (agm_primeira_consulta != '') {
                    html[id_horas_sem_ponto] = html[id_horas_sem_ponto] + ope_nome +'</span></td><td id="buttonProntuario"></td><td><span class="consulta">' + agm_primeira_consulta + '</span></td></tr>';
                } else if (agm_agendamento_confirmado != '') {
                    html[id_horas_sem_ponto] = html[id_horas_sem_ponto] + ope_nome +'</span></td><td id="buttonProntuario"></td><td><span class="confirmado">' + agm_agendamento_confirmado + '</span></td></tr>';
                } else if (id_beneficiarios) {
                    html[id_horas_sem_ponto] = html[id_horas_sem_ponto] + ope_nome + '</span></td><td id="buttonProntuario"></td><td></td></tr>';
                } else {
                    html[id_horas_sem_ponto] = html[id_horas_sem_ponto] + '</span></td><td id="buttonProntuario"></td><td></td></tr>';
                }
            } else {
                html[id_horas_sem_ponto] = '<tr id="' + id_horas_sem_ponto + '" class="' + horarios_semana[i] + '" data-toggle="modal" data-target="#myModal" onclick="Modal(this,this.id)"><td> ' + horarios_semana[i] + '</td> <td><span id="nome_paciente'+controle+'"></span></td><td></td><td></td></tr>';
            }
                    } else {
                        id_horas_sem_ponto = '999';
                        html[id_horas_sem_ponto] = '<tr> <td colspan="4"> <center><i class="fa fa-exclamation-triangle fa-2x fonte_blue_logo"></i> Não foram disponibilizados horários para atendimento nesta data.</center> </td> </tr>';
                    }
                    
                    
                    //LIMPA VARIAVEIS
                    id_agendas_marcacoes = '';
                    id_beneficiarios = '';
                    id_operadoras = '';
                    id_tipo_agendamento = '';
                    agm_paciente_nome = '';
                    ope_nome = '';
                    ben_numero_carteira = '';
                    ben_validade_carteira = '';
                    celular = '';
                    telefone = '';
                    agm_observacao = '';
            
                    agm_primeira_consulta = '';
                    agm_agendamento_confirmado = '';
                    status_agendamento = '';
                    agm_bloqueio_descricao = '';
                    
                    controle++;
            
                }
            
                $('#tbody-table-hours').append(html);
            
                $('.vermelho').parent().parent().attr('data-target','#myModalGeral');
                $('.vermelho').parent().parent().attr('onclick','ModalAtendimento(this,this.id)');
                $('.vermelho').parent().attr('data-target','#myModalGeral');
                $('.vermelho').parent().attr('onclick','ModalAtendimento(this,this.id)');
                
                $('.verde').parent().parent().attr('data-target','#myModalGeral');
                $('.verde').parent().parent().attr('onclick','ModalAtendimento(this,this.id)');
                $('.verde').parent().attr('data-target','#myModalGeral');
                $('.verde').parent().attr('onclick','ModalAtendimento(this,this.id)');
            
                $('.bloqueado').parent().parent().attr('data-target','#myModalGeral');
                $('.bloqueado').parent().parent().attr('onclick','ModalBloqueado(this,this.id)');
                $('.bloqueado').parent().attr('data-target','#myModalGeral');
                $('.bloqueado').parent().attr('onclick','ModalBloqueado(this,this.id)');
                $('.bloqueado').parent().attr('text','ModalBloqueado(this,this.id)');
            
            $('.azul').parent().parent().attr('data-target','#myModalGeral');
                $('.azul').parent().parent().attr('onclick','ModalAtendimento(this,this.id)');
                $('.azul').parent().attr('data-target','#myModalGeral');
                $('.azul').parent().attr('onclick','ModalAtendimento(this,this.id)');
                
                $('.texto_faturado').parent().parent().attr('data-target','#myModalGeral');
                $('.texto_faturado').parent().parent().attr('onclick','ModalAtendimento(this,this.id)');
                $('.texto_faturado').parent().attr('data-target','#myModalGeral');
                $('.texto_faturado').parent().attr('onclick','ModalAtendimento(this,this.id)');        
                
                
                $('.vermelho').each(function(){
                    $(this).parent().parent().children().eq(2).html('<button type="button" class="btn-atender" onclick="abrirProntuario(\''+$(this).attr('id')+'\',\''+$(this).parent().parent().attr('id')+'\')">Atender</button>');
                });
            
            }
            
            function myFunction(x, id) {
                alert("Cell index is: " + id);
            }
            
            function TrataDataBr(data_completa) {
                var data_hora = [];
                dia = data_completa.substr(8, 2); //DIA
                mes = data_completa.substr(5, 2); //MES
                ano = data_completa.substr(0, 4); //ANO                
            
                hora = data_completa.substr(11, 5); // HORA:Minuto
            
                data_br = dia + '/' + mes + '/' + ano;
            
                data_hora[0] = data_br;
                data_hora[1] = hora;
            
                return data_hora;
            }
            
            function DayOfWeekName(Week) {
            
                if (Week == 0) {
                    dayOfWeekName = 'Domingo';
                } else if (Week == 1) {
                    dayOfWeekName = 'Segunda';
                } else if (Week == 2) {
                    dayOfWeekName = 'Terça';
                } else if (Week == 3) {
                    dayOfWeekName = 'Quarta';
                } else if (Week == 4) {
                    dayOfWeekName = 'Quinta';
                } else if (Week == 5) {
                    dayOfWeekName = 'Sexta';
                } else if (Week == 6) {
                    dayOfWeekName = 'Sábado';
                }
                return dayOfWeekName;
            }
            
            function checkDd(dd) {
                if ((dd < 10) && (dd.toString().length == 1)) {
                    dd = '0' + dd;
                }
                return dd;
            }
            function checkMm(mm) {
                if ((mm < 10) && (mm.toString().length == 1)) {
                    mm = '0' + mm;
                }
                return mm;
            }
            
            function dia_hoje() {
                dd = hoje.getDate();
                mm = hoje.getMonth() + 1; //Janeiro é 0!
                yyyy = hoje.getFullYear();
            
                dd = checkDd(dd);
                mm = checkMm(mm);
            
                var data_hoje = dd + '/' + mm + '/' + yyyy;
                $('#datepicker').datepicker("setDate", data_hoje);
                obter_dados_post(yyyy+'-'+mm+'-'+dd);
            }
            
            function dia_anterior() {
                dd--;
            
                if (dd == 0) {
                    mm--;
                    if (mm == 0) {
                        mm = '12';
                        yyyy--;
                    }
                    if ((mm != 2)) {
                        dd = ListofDays[mm - 1];
                    } else {
                        var lyear = false;
                        if ((!(yyyy % 4) && yyyy % 100) || !(yyyy % 400)) {
                            dd == '29';
                        }
                    }
            
                }
            
                dd = checkDd(dd);
                mm = checkMm(mm);
            
                var anterior = dd + '/' + mm + '/' + yyyy;
                $('#datepicker').datepicker("setDate", anterior);
                obter_dados_post(yyyy+'-'+mm+'-'+dd);
            }
            
            function dia_posterior() {
                dd++;
            
                if(dd > ListofDays[mm - 1]){
                    if ((mm != 2)) {
                        if (mm == '12') {
                            mm = '1';
                            yyyy++;
                        }else{
                            mm++;
                        }
            
                        dd = '1';
                    } else {
                        if(dd == '29' && (!(yyyy % 4) && yyyy % 100) || !(yyyy % 400)){
                            dd = '29';
                        }else{
                            dd = '1';
                            mm++;
                        }
                    }
                }
                
            
                dd = checkDd(dd);
                mm = checkMm(mm);
            
                var posterior = dd + '/' + mm + '/' + yyyy;
            
                if (validatedate(posterior)) {
                    $('#datepicker').datepicker("setDate", posterior);
                    obter_dados_post(yyyy+'-'+mm+'-'+dd);
                }
            }
            
            function validatedate(data_passed) {
                // var dateformat = /^(0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])[\/\-]\d{4}$/;
                var dateformat = /[0-9]{2}\/[0-9]{2}\/[0-9]{4}/;
            
                // Match the date format through regular expression
                if (data_passed.match(dateformat)) {
            
                    //Test which seperator is used '/' or '-'
                    var opera1 = data_passed.split('/');
                    var lopera1 = opera1.length;
            
                    // Extract the string into month, date and year
                    if (lopera1 > 1) {
                        var pdate = data_passed.split('/');
                    }
                    var dd = parseInt(pdate[0]);
                    var mm = parseInt(pdate[1]);
                    var yyyy = parseInt(pdate[2]);
            
                    // Create list of days of a month [assume there is no leap year by default]  
                    
                    if ((mm != 2)) {
                        if (dd > ListofDays[mm - 1]) {
                            return false;
                        }
                    } else {
                        var lyear = false;
                        if ((!(yyyy % 4) && yyyy % 100) || !(yyyy % 400)) {
                            lyear = true;
                        }
                        if ((lyear == false) && (dd >= 29)) {
                            return false;
                        }
                        if ((lyear == true) && (dd > 29)) {
                            return false;
                        }
                    }
                    
                    if (yyyy == 0) {
                        return false;
                    }
                                
                    return true;
                } else {
                    return false;
                }
            }
            
            function primeiro_horario(){
                $.get('https://app.4clinics.software/agenda/primeiro_horario/'+id_agendas,
                    function (data) {
                        if(data){                    
                            var json = $.parseJSON(data);
                            $('#myModalGeral3 .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Horários Disponíveis:</h4>');
                            $('#myModalGeral3 .modal-body').html('<p>Primeiro Horario disponível para agendamento é em <strong>'+json.data+', às '+json.horario+'</strong></p>');
                            $('#myModalGeral3 .modal-footer').html('<button type="button" class="btn btn-default pull-left" data-dismiss="modal">Fechar</button><button type="button" class="btn btn-primary right" onclick="dia_horario_disponivel(\''+json.data+'\',\''+json.horario+'\')" data-dismiss="modal">Ir para o dia com horário disponível!</button>');
                            $('#btnModalGeral3').trigger('click');
                        }
                    });
            }
            
            function imprimir(){}
            
            function dia_horario_disponivel(data_disponivel, hora_disponivel){
                $('#datepicker').datepicker("setDate", data_disponivel);
                dd_disponivel = $("#datepicker").datepicker('getDate').getDate();
                mm_disponivel = $("#datepicker").datepicker('getDate').getMonth() + 1; //Janeiro é 0!
                yyyy_disponivel = $("#datepicker").datepicker('getDate').getFullYear();
                data_disponivel = yyyy_disponivel+'-'+checkMm(mm_disponivel)+'-'+checkDd(dd_disponivel);
                obter_dados_post(data_disponivel);
            }
            
            $("#agm_paciente_nome").select2({
                locale: 'pt',
                placeholder: "Buscar...",
                minimumInputLength: 5,
                ajax: {
                    url: "https://app.4clinics.software/agenda/buscar_beneficiario",
                    dataType: 'json',
                    quietMillis: 250,
                    width: 400,
                    data: function (term, page) {
                        return {
                            q: term,
                            id_agd: id_agendas
                        }
                    },
                    results: function (data, page) {
                        return {results: data.items}
                    },
                    cache: false
                },
                initSelection: function (element, callback) {
                    var id = $(element).val();
                    if (id != "") {
                        $.ajax("https://app.4clinics.software/agenda/buscar_beneficiario/?value=" + id, {
                            dataType: "json"
                        }).done(function (data) {
                            callback(data);
                        })
                    }            
                },
                formatResult: repoFormatResult,
                formatSelection: repoFormatSelection,
                dropdownCssClass: "bigdrop",
                escapeMarkup: function (m) {
                    return m
                }
            });
            
            
            function repoFormatResult(repo) {
                var markup = '<div class="row">' +
                '<div class="col-xs-12">' +
                '<div class="row">' +
                '<div class="col-xs-12">' + repo.full_name + '</div>' +
                '</div>';
                markup += '</div></div>';
            
                return repo.full_name;
            }
            
            function repoFormatSelection(repo) {
            
                $('#agm_primeira_consulta').prop('disabled', false);
                $('#agm_primeira_consulta').prop('checked', false);
                $('#id_operadoras').val('0');
                $('#id_beneficiarios').val('');
                $('#agm_paciente_telefone').val('');
                $('#agm_paciente_telefone_fixo').val('');
                $('#agm_paciente_email').val('');
                document.getElementById('data-ultima-consulta').innerHTML = ('');
                if(!repo.nome){
                    $('#agm_paciente_nome').val(repo.full_name.toUpperCase());
                    $('#id_beneficiarios').val('');
                    $('label[for="agm_paciente_nome"][class="error"]').remove();
                    if(repo.primeira_consulta == 1){
                        $('#agm_primeira_consulta').prop('disabled', true);
                    }else{
                        $('#agm_primeira_consulta').prop('checked', true)
                    }
                    return repo.full_name.toUpperCase();
                }else{
                    $('#agm_paciente_nome').val(repo.nome);
                    $('#id_beneficiarios').val(repo.id);
                    $('label[for="agm_paciente_nome"][class="error"]').remove();
                    $('#agm_paciente_telefone').val(repo.celular);
                    $('#agm_paciente_telefone_fixo').val(repo.telefone);
                    $('#agm_paciente_email').val(repo.email);
                    
                    if ((repo.ultima_consulta != 0) && (repo.ultima_consulta != null)){
                        document.getElementById('data-ultima-consulta').innerHTML = (' <i class="fa fa-calendar fa-fw"> </i> Última consulta: '+repo.ultima_consulta);
                    }
                    if(repo.primeira_consulta == 1){
                        $('#agm_primeira_consulta').prop('disabled', true);
                    }else{
                        $('#agm_primeira_consulta').prop('checked', true)
                    }
                    return repo.nome.toUpperCase();
                }
            }
            
            $("#agm_paciente_nome_e").select2({
                locale: 'pt',
                placeholder: "Buscar...",
                minimumInputLength: 5,
                ajax: {
                    url: "https://app.4clinics.software/agenda/buscar_beneficiario",
                    dataType: 'json',
                    quietMillis: 250,
                    width: 400,
                    data: function (term, page) {
                        return {
                            q: term,
                            id_agd: id_agendas
                        }
                    },
                    results: function (data, page) {
                        return {results: data.items}
                    },
                    cache: false
                },
                initSelection: function (element, callback) {
                    var id = $(element).val();
                    if (id != "") {
                        $.ajax("https://app.4clinics.software/agenda/buscar_beneficiario/?value=" + id, {
                            dataType: "json"
                        }).done(function (data) {
                            callback(data);
                        })
                    }            
                },
                formatResult: repoFormatResult2,
                formatSelection: repoFormatSelection2,
                dropdownCssClass: "bigdrop",
                escapeMarkup: function (m) {
                    return m
                }
            });
            
            function repoFormatResult2(repo) {
                var markup = '<div class="row">' +
                '<div class="col-xs-12">' +
                '<div class="row">' +
                '<div class="col-xs-12">' + repo.full_name + '</div>' +
                '</div>';
                markup += '</div></div>';
            
                return repo.full_name;
            }
            
            function repoFormatSelection2(repo) {
                $('#agm_primeira_consulta_e').prop('disabled', false);
                $('#agm_primeira_consulta_e').prop('checked', false);
                $('#id_operadoras_e').val('0');
                $('#id_beneficiarios_e').val('');
                $('#agm_paciente_telefone').val('');
                $('#agm_paciente_telefone_fixo').val('');
                $('#agm_paciente_email').val('');
                if(!repo.nome){
                    $('#agm_paciente_nome_e').val(repo.full_name.toUpperCase());
                    $('#id_beneficiarios_e').val('');
                    $('label[for="agm_paciente_nome_e"][class="error"]').remove();
                    if(repo.primeira_consulta == 1){
                        $('#agm_primeira_consulta_e').prop('disabled', true);
                    }else{
                        $('#agm_primeira_consulta_e').prop('checked', true)
                    }
                    return repo.full_name.toUpperCase();
                }else{
                    $('#agm_paciente_nome_e').val(repo.nome);
                    $('#id_beneficiarios_e').val(repo.id);
                    $('label[for="agm_paciente_nome_e"][class="error"]').remove();
                    $('#agm_paciente_telefone_e').val(repo.celular);
                    $('#agm_paciente_telefone_fixo_e').val(repo.telefone);
                    $('#agm_paciente_email_e').val(repo.email);
                    if(repo.primeira_consulta == 1){
                        $('#agm_primeira_consulta_e').prop('disabled', true);
                    }else{
                        $('#agm_primeira_consulta_e').prop('checked', true)
                    }
                    return repo.nome.toUpperCase();
                }    
            }
            
            /*-----------------------------------------------------------------------
            | Poder alterar o nome na confirmação
            | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
            | Em : 21/03/2016
            |----------------------------------------------------------------------*/
            $("#agm_paciente_nome_c").select2({
                locale: 'pt',
                placeholder: "Buscar...",
                minimumInputLength: 5,
                ajax: {
                    url: "https://app.4clinics.software/agenda/buscar_beneficiario",
                    dataType: 'json',
                    quietMillis: 250,
                    width: 400,
                    data: function (term, page) {
                        return {
                            q: term,
                            id_agd: id_agendas
                        }
                    },
                    results: function (data, page) {
                        return {
                            results: data.items
                        }
                    },
                    cache: false
                },
                initSelection: function (element, callback) {
                    var id = $(element).val();
                    if (id != "") {
                        $.ajax("https://app.4clinics.software/agenda/buscar_beneficiario/?value=" + id, {
                            dataType: "json"
                        }).done(function (data) {
                            console.log(data);
                            callback(data);
                        })
                    }            
                },
                formatResult: repoFormatResult3,
                formatSelection: repoFormatSelection3,
                dropdownCssClass: "bigdrop",
                escapeMarkup: function (m) {
                    return m
                }
            })
            .on("select2-loaded", function(e) {
                resultados_vazios();
            });
            
            function repoFormatResult3(repo) {
                var vetor = [];
                var nome_temp = $('#agm_paciente_nome_c').val();
                var indice = -1;
                var count = 0;
                var ress = [];
                var verdadeiro = null;
                var ponteiro = null;
                var resultado_ver = {};
            
                while(nome_temp.indexOf(' ') != -1){
                    indice = parseInt(nome_temp.indexOf(' '));
                    vetor.push(nome_temp.substring(0, indice));
                    indice++;
                    nome_temp = nome_temp.substring(indice);
                }
                vetor.push(nome_temp);
            
            
                for(var i in vetor){
                    if(repo.full_name.indexOf(vetor[i]) != -1){
                        ress.push(repo.full_name);
                    }
                }
            
            
                for(var k=0; k < ress.length; k++){
                    ponteiro = ress[k];
                    if(ress[k+1] && ress[k+1] == ponteiro){
                        verdadeiro = ress[k];
                    }
                    k++;
                }
            
                if(verdadeiro != ''){
                    return verdadeiro;
                }else{
                    resultado_ver.full_name = verdadeiro;
                    resultado_ver.disabled = true;
            
                    return resultado_ver;
                }        
            }
            
            function repoFormatSelection3(repo) {
                $('#agm_primeira_consulta_c').prop('disabled', false);
                $('#agm_primeira_consulta_c').prop('checked', false);
                // $('#id_operadoras_c').val('0');
                $('#id_beneficiarios_c').val('');
                $('#agm_paciente_telefone').val('');
                $('#agm_paciente_telefone_fixo').val('');
                $('#agm_paciente_email').val('');
                if(!repo.nome){
                    $('#agm_paciente_nome_c').val(repo.full_name.toUpperCase());
                    $('#id_beneficiarios_c').val('');
                    $('label[for="agm_paciente_nome_c"][class="error"]').remove();
                    if(repo.primeira_consulta == 1){
                        $('#agm_primeira_consulta_c').prop('disabled', true);
                    }else{
                        $('#agm_primeira_consulta_c').prop('checked', true)
                    }
                    return repo.full_name.toUpperCase();
                }else{
                    $('#agm_paciente_nome_c').val(repo.nome);
                    $('#id_beneficiarios_c').val(repo.id);
                    $('label[for="agm_paciente_nome_c"][class="error"]').remove();
                    $('#agm_paciente_telefone_c').val(repo.celular);
                    $('#agm_paciente_telefone_fixo_c').val(repo.telefone);
                    $('#agm_paciente_email_c').val(repo.email);
                    if(repo.primeira_consulta == 1){
                        $('#agm_primeira_consulta_c').prop('disabled', true);
                    }else{
                        $('#agm_primeira_consulta_c').prop('checked', true)
                    }
                    return repo.nome.toUpperCase();
                }
            }
            
            function resultados_vazios(){
                setTimeout(function(){
                    $('.select2-results').children().each(function(){
                        if($(this).children().html() == ''){
                            $(this).remove();
                        }
                    });
                },50);        
            }
            
            function recarregar(data_){
                if (data_) {
                    setTimeout(function(){
                        window.location.href = 'https://app.4clinics.software/agenda/prepara_agenda'+'/'+id_agendas+'/'+data_;
                    }, 50);
                }else{
                    setTimeout(function(){
                        window.location.href = window.location.href;
                    }, 50);
                }
            }
            
            function bloquearHorario(){
                var horaInicial = $('#hora_modal').val();
                $('#hora_modal_b').val(horaInicial);
                $('#btnModalBloqueio').trigger('click');
            }
            
            function bloquearHorario_continuar(){
                var agm_bloqueio_descricao = $('#agm_bloqueio_descricao_b').val();
                var horaInicial = $('#hora_modal_b').val();
            
                if (horaInicial.length == 3) {
                    var hora1 = horaInicial.toString().substring(0, 1);
                    var hora2 = horaInicial.toString().substring(1);
                    var horaFinal = '0'+hora1+':'+hora2;
                }
                if(horaInicial.length == 4){
                    var hora1 = horaInicial.toString().substring(0, 2);
                    var hora2 = horaInicial.toString().substring(2);
                    var horaFinal = hora1+':'+hora2;
                }
            
                var dd = checkDd($("#datepicker").datepicker('getDate').getDate());
                var mm = checkMm($("#datepicker").datepicker('getDate').getMonth() + 1);
                var yyyy = $("#datepicker").datepicker('getDate').getFullYear();
            
                $.post('https://app.4clinics.software/agenda/salvar_periodo_bloqueio_horario',
                {
                    id_agendas: id_agendas,
                    desc_bloqueio: agm_bloqueio_descricao,
                    date_ini: horaFinal,
                    dia_bloqueio: dd+'/'+mm+'/'+yyyy
                },
                function(data){
                    if(!data){
                        $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Bloqueio:</h4>');
                        $('#myModalGeral .modal-body').html('<p>Bloqueio Registrado com Sucesso!</p>');
                        $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="recarregar(\''+dd+'/'+mm+'/'+yyyy+'\')">Fechar</button>');
                        $('#btnModalGeral').trigger('click');
                    }
                });
            }
            
            function salvar_e_fechar(){
                var id_agendas_marcacoes_ = $('#id_agendas_marcacoes_c').val();
                var id_beneficiarios_ = $('#id_beneficiarios_c').val();
                var id_operadoras_ = $('#id_operadoras_c').val();
                var id_tipo_agendamento_ = $('#id_tipo_agendamento_c').val();
                var ben_nome_a = $('#agm_paciente_nome_c').val();
                var indd = ben_nome_a.indexOf('-');
                if(indd > 0){
                    var ben_nome_ = ben_nome_a.substring(0, (indd - 1));
                }else{
                    var ben_nome_ = ben_nome_a;
                }
                var ben_numero_carteira_ = $('#ben_numero_carteira_c').val();
                var ben_validade_carteira_ = $('#ben_validade_carteira_c').val();
                var ben_celular_ = $('#agm_paciente_telefone_c').val();
                var ben_telefone_ = $('#agm_paciente_telefone_fixo_c').val();
                var agm_paciente_email_ = $('#agm_paciente_email_c').val();
                var agm_observacao_ = $('#agm_observacao_c').val();
                var primeira_consulta_ = $('#agm_primeira_consulta_c').prop('checked');
                var agendamento_confirmado_ = $('#agm_agendamento_confirmado_c').prop('checked');
                var id_modal = $('#hora_modal_c').val();
            
                var dd = checkDd($("#datepicker").datepicker('getDate').getDate());
                var mm = checkMm($("#datepicker").datepicker('getDate').getMonth() + 1);
                var yyyy = $("#datepicker").datepicker('getDate').getFullYear();
            
                //if(agendamento_confirmado_ == false){
                //  $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">Agendamento:</h4>');
                //  $('#myModalGeral .modal-body').html('<p>É necessário selecionar "Agendamento Confirmado"!</p>');
                //  $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-default pull-right" data-dismiss="modal" onclick="$(\'#'+id_modal+'\').trigger(\'click\');">OK</button>');
                //  $('#btnModalGeral').trigger('click');
                //}else{
                    $.post('https://app.4clinics.software/agenda/salvar_e_fechar',
                        {id_agendas: id_agendas,
                            id_agendas_marcacoes: id_agendas_marcacoes_,
                            id_beneficiarios: id_beneficiarios_,
                            id_operadoras: id_operadoras_,
                            id_tipo_agendamento: id_tipo_agendamento_,
                            agm_paciente_nome: ben_nome_,
                            ben_numero_carteira: ben_numero_carteira_,
                            ben_validade_carteira: ben_validade_carteira_,
                            agm_paciente_telefone: ben_celular_,
                            agm_paciente_telefone_fixo: ben_telefone_,
                            agm_paciente_email: agm_paciente_email_,
                            agm_observacao: agm_observacao_,
                            agm_primeira_consulta: primeira_consulta_,
                            agm_agendamento_confirmado: agendamento_confirmado_
                        },
                        function (data) {
                            if (!data) {
                                $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Agendamento:</h4>');
                                $('#myModalGeral .modal-body').html('<p>Informações atualizadas com sucesso!</p>');
                                $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="recarregar(\''+dd+'/'+mm+'/'+yyyy+'\')">OK</button>');
                                $('#btnModalGeral').trigger('click');
                            }
                        });
                //}
            }
            
            function reagendar_agendamento(){
                var iagmagc = 0;
            
                iagmagc = $('#id_agendas_marcacoes_c').val();
            
                document.getElementById('modal-title_r').innerHTML = ($('#modal-title_c').html());
                document.getElementById('data-modal_r').innerHTML = ($('#data-modal_c').html()); 
                document.getElementById('paciente_nome_r').innerHTML = ($('#agm_paciente_nome_c').val());
                
                $('#id_agendas_marcacoes_r').val(iagmagc);
                $('#id_beneficiarios_r').val($('#id_beneficiarios_c').val());
            
            $('#agm_paciente_data_r').val($('#data-modal_c').html());
            $('#agm_paciente_hora_r').val($('#modal-title_c').html());        
                
                $('#btnModalReagendamento').trigger('click');
            
                /*-----------------------------------------------------------------------
                | Se for null, quer dizer que é uma consulta normal, travamos o "Reagendar como encaixe"
                | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                | Em : 20/06/2016
                |----------------------------------------------------------------------*/
                setTimeout(function(){
                    for(var i in json.data_grade_horario){
                        if(json.data_grade_horario[i].id_agendas_marcacoes == iagmagc){                
                            if(json.data_grade_horario[i].ids_horario_extendido != null){
                                $('#mostrar_encaixe_reagendar_check').parent().children().eq(1).hide();
                                $('#mostrar_encaixe_reagendar_check').hide();
                            }
                        }
                    }
                },300);        
            
                carregar_agenda_horarios_reagendamento();
            }
            
            function carregar_agenda_horarios_reagendamento(){
                setTimeout(function(){
                    dd = $("#agm_paciente_data_r").datepicker('getDate').getDate();
                    mm = $("#agm_paciente_data_r").datepicker('getDate').getMonth() + 1; //Janeiro é 0!
                    yyyy = $("#agm_paciente_data_r").datepicker('getDate').getFullYear();
                    data_p = yyyy+'-'+checkMm(mm)+'-'+checkDd(dd);
                    obter_dados_post_r(data_p);
                },100);
            }    
            
            function gravar_reagendamento(){
                var gr_id_agendas_marcacoes = $('#id_agendas_marcacoes_r').val();
            var gr_agm_paciente_data = $('#agm_paciente_data_r').val();
                var gr_agm_paciente_hora = $('#agm_paciente_hora_r').val();
                var gr_agm_paciente_encaixe_hora = $('#agm_paciente_encaixe_hora_r').val();
                var gr_agm_paciente_hora_final = null;
            var gr_agm_paciente_encaixe = 'N';
                var gr_tempo_atendimento = json.data_agenda_config[0].agc_tempo_atendimento;
            var gr_continuar = true;
            
            var datePart = gr_agm_paciente_data.match(/\d+/g),
            yyyy = datePart[2], mm = datePart[1], dd = datePart[0];
            
                if($('#mostrar_encaixe_reagendar_check').is(':checked')){
                    gr_agm_paciente_hora_final = gr_agm_paciente_encaixe_hora;
                    gr_agm_paciente_encaixe = 'S';
                }else{
                    gr_agm_paciente_hora_final = gr_agm_paciente_hora;
                }
            
            if ((gr_agm_paciente_data == '') || (gr_agm_paciente_hora == '')){
                    gr_continuar = false;
                }
            
                if(gr_continuar){            
                    $.post('https://app.4clinics.software/agenda/reagendar_marcacao',
                        {id_agendas_marcacoes: gr_id_agendas_marcacoes,
                            agm_data: gr_agm_paciente_data,
                            agm_hora: gr_agm_paciente_hora_final,
                            agm_encaixe: gr_agm_paciente_encaixe,
                            id_agendas: id_agendas,
                            agm_tempo_consulta: gr_tempo_atendimento,                    
                        },
                        function (data) {
                            if (!data) {
                                $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Reagendamento:</h4>');
                                $('#myModalGeral .modal-body').html('<p>Reagendamento realizado com sucesso!</p>');
                                $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="recarregar(\''+dd+'/'+mm+'/'+yyyy+'\')">OK</button>');
                                $('#btnModalGeral').trigger('click');
                            }else{
                                $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Reagendamento:</h4>');
                                $('#myModalGeral .modal-body').html('<p>Não foi possível reagendar! O Horário já foi preenchido, por favor atualize sua página clicando no "OK" abaixo.</p>');
                                $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="recarregar(\''+dd+'/'+mm+'/'+yyyy+'\')">OK</button>');
                                $('#btnModalGeral').trigger('click');
                            }
                        });
                }else{
                    $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Reagendamento:</h4>');
                    $('#myModalGeral .modal-body').html('<p>Para executar o reagendamento é necessário informar os campos:<br> <strong>Data e Horário.</strong></p>');
                    $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="reagendar_agendamento()">OK</button>');
                    $('#btnModalGeral').trigger('click');
                }
            }
            
            function faturamento_consulta(id){
                var paciente_nome = $('#'+id).children().eq(1).children().attr('agm_paciente_nome');
                var operadora_nome = $('#'+id).children().eq(1).children().attr('ope_nome');
                var id_beneficiarios = 0; 
                var json_ = JSON.parse($('#'+id).children().eq(1).children().attr('json'));
                var ben_cpf = '';
                var data_fat = '';
                /*-----------------------------------------------------------------------
                | Alterado para obter os valores novos do cadastro do executante
                | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                | Em : 29/06/2016
                |----------------------------------------------------------------------*/
                //var str_valor_procedimento = '';
                // var str_codigo_procedimento = '';
                // var str_descricao_procedimento = '';
                var str_valor_procedimento = '';
                var str_codigo_procedimento = '';
                var str_descricao_procedimento = '';
                var id_agendas_fat = '';
                var id_agendas_marcacoes_fat = '';
                var dd_hoje = hoje.getDate();
            var mm_hoje = hoje.getMonth() + 1; //Janeiro é 0!
            var yyyy_hoje = hoje.getFullYear();
            dd_hoje = checkDd(dd_hoje);
            mm_hoje = checkMm(mm_hoje);
            var data_hoje = dd_hoje + '/' + mm_hoje + '/' + yyyy_hoje;
                
                if (json_.agm_data_hora_marcacao) {
                    var dd = json_.agm_data_hora_marcacao.substr(5,2);
                    var mm = json_.agm_data_hora_marcacao.substr(8,2);
                    var yyyy = json_.agm_data_hora_marcacao.substr(0,4);
                    var hh = json_.agm_data_hora_marcacao.substr(11,5);
                    var data = dd+'/'+mm+'/'+yyyy;          
                }
                
                if (json_.ben_cpf) {
                    ben_cpf = json_.ben_cpf;
                    $('#ben_cpf').val(ben_cpf);
                } else {
                    $('#ben_cpf').val('');
                }
                
                if (json_.id_agendas) {
                    id_agendas_fat = json_.id_agendas;
                    $('#id_agendas_fat').val(id_agendas_fat);
                } else {
                    $('#id_agendas_fat').val('');
                }
                
                if (json_.id_agendas_marcacoes) {
                    id_agendas_marcacoes_fat = json_.id_agendas_marcacoes;
                    $('#id_agendas_marcacoes_fat').val(id_agendas_marcacoes_fat);
                } else {
                    $('#id_agendas_marcacoes_fat').val('');
                }
                
            if ($('#'+id).children().eq(1).children().attr('id_beneficiarios')) {
            id_beneficiarios = $('#'+id).children().eq(1).children().attr('id_beneficiarios');
            }
                $('#id_beneficiarios_fat').val(id_beneficiarios);
                
                $('#vcm_vencimento').val(data_hoje);
                $('#lcm_valor').val(str_valor_procedimento);
                $('#select2-chosen-4').html(str_descricao_procedimento);
                $('#id_tuss_procedimento').val(str_codigo_procedimento);
                $('#id_horario_dia_fat').val(id); 
                
                document.getElementById('profissional_nome_fat').innerHTML = 'WASHINGTON CLIMACO888.888.888-88'; 
                document.getElementById('paciente_nome_fat').innerHTML = paciente_nome+' '+operadora_nome;
                document.getElementById('data_hora_fat').innerHTML = dd+'/'+mm+'/'+yyyy+' às '+hh;
                
                $('#btnModalFaturamento').trigger('click');
            }
            
            function faturar_atendimento() {
            
                var id_fat = $('#id_horario_dia_fat').val();
                var ben_cpf = $('#ben_cpf').val();
                var lcm_valor = $('#lcm_valor').val();        
                var vcm_vencimento = $('#vcm_vencimento').val();
                var vcm_pago = $('#vcm_pago').prop('checked');
                var id_contas_bancarias = $('#id_contas_bancarias').val();
                var id_aux_formas_pagamento = $('#id_aux_formas_pagamento').val();
                var id_agendas = $('#id_agendas_fat').val();
                var id_agendas_marcacoes = $('#id_agendas_marcacoes_fat').val();
                var id_tuss_procedimento = $('#id_tuss_procedimento').val();
                var id_centro_custo = $('#id_centro_custo').val();
                var continuar = true;
                var dd_fat = checkDd($("#datepicker").datepicker('getDate').getDate());
                var mm_fat = checkMm($("#datepicker").datepicker('getDate').getMonth() + 1);
                var yyyy_fat = $("#datepicker").datepicker('getDate').getFullYear();
                //var data = dd+'/'+mm+'/'+yyyy;
            
                if ((ben_cpf == '') || (vcm_vencimento == '') || (lcm_valor == '') || (id_contas_bancarias == '') || (id_aux_formas_pagamento == '')){
                    continuar = false;
                }
                
                if(continuar){
                    $.post('https://app.4clinics.software/agenda/registrar_faturamento',
                        {id_agendas: id_agendas,
                            id_agendas_marcacoes: id_agendas_marcacoes,
                            ben_cpf: ben_cpf,
                            vcm_vencimento: vcm_vencimento,
                            lcm_valor: lcm_valor,
                            id_contas_bancarias: id_contas_bancarias,
                            id_aux_formas_pagamento: id_aux_formas_pagamento,
                            vcm_pago: vcm_pago,
                            id_tuss_procedimento: id_tuss_procedimento,
                            id_centro_custo: id_centro_custo
                        },
                        function (data) {
                            if (!data) {
                                /*-----------------------------------------------------------------------
                                | Movida a mensagem para outra função
                                | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                                | Em : 30/06/2016
                                |----------------------------------------------------------------------*/
                                antesAbrirReciboFaturamento(dd_fat, mm_fat, yyyy_fat);                        
                            }
                        });
                }else{
                    $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Faturamento:</h4>');
                    $('#myModalGeral .modal-body').html('<p>Para o registro do Faturamento é necessário informar pelo menos, os campos: <strong>CPF, Data, Valor, Conta e Forma de Pagamento</strong>!</p>');
                    $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="faturamento_consulta(\''+id_fat+'\')">OK</button>');
                    $('#btnModalGeral').trigger('click');
                }
            }
            
            /*-----------------------------------------------------------------------
            | Mesagem de sucesso ao salvar o faturamento
            | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
            | Em : 30/06/2016
            |----------------------------------------------------------------------*/
            function antesAbrirReciboFaturamento(dd_fat, mm_fat, yyyy_fat) {
                $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Faturamento:</h4>');
                $('#myModalGeral .modal-body').html('<p>Faturamento realizado com sucesso!</p>');
                $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-default pull-left" data-dismiss="modal" onclick="recarregar(\''+dd_fat+'/'+mm_fat+'/'+yyyy_fat+'\')">Fechar</button><button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="abrirReciboFaturamento(\''+dd_fat+'\',\''+mm_fat+'\',\''+yyyy_fat+'\')">Imprimir recibo</button>');
                $('#btnModalGeral').trigger('click');
            }
            
            /*-----------------------------------------------------------------------
            | Para mostrar o recibo do faturamento
            | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
            | Em : 30/06/2016
            |----------------------------------------------------------------------*/
            function abrirReciboFaturamento(dd_fat, mm_fat, yyyy_fat) {
                var html, json_, valor, cod_procedimento, desc_procedimento;
            
                json_ = JSON.parse($('#'+$('#id_horario_dia_fat').val()).children().eq(1).children().attr('json'));
                valor = $('#lcm_valor').val();
                cod_procedimento = $('#id_tuss_procedimento').val();
                desc_procedimento = $('#select2-chosen-4').html();
            
                html = '<p>&nbsp;</p>';
                html += '<center>';
                html += '<p>RECIBO</p>';
                html += '<br>';
                html += '<p>';
                html += 'Recebi de ';
                html += json_.agm_paciente_nome;
                html += ', o valor R$ ';
                html += valor;
                html += ', referente ao procedimento ';
                html += cod_procedimento+' - '+desc_procedimento;
                html += '.</p>';
                html += '<br>';
                html += '<p>';
                html += dd_fat+'/'+mm_fat+'/'+yyyy_fat;
                html += '</p>';
                html += '<br><br>';
                html += '<p>';
                html += '______________________________________________';
                html += '</p>';
                html += '<p>';
                html += ' -  ';
                html += '</p>';
                html += '</center>';
                destroyTinyMCE();
            
                $('#textImpressao').val(html);
            
                setTimeout(function(){
                    startTinyMCE();
                },500);        
            }
            
            function destroyTinyMCE(){
                if(tinymce.editors.length > 0){
                    tinymce.remove('#textImpressao');
                }
            }
            
            function startTinyMCE(){
                tinymce.init({
                    selector: "#textImpressao", 
                    theme: "modern",
                    language : "pt_BR",
                    height: "400px",
                    statusbar: false,
                    //plugins : "print",
                    plugins : [
                    "advlist autolink lists link image charmap print preview hr anchor pagebreak",
                    "searchreplace wordcount visualblocks visualchars code fullscreen",
                    "insertdatetime media nonbreaking save table contextmenu directionality",
                    "emoticons template paste textcolor colorpicker textpattern imagetools"
                    ],
                    theme_advanced_buttons3_add : "print",
                    toolbar: "print undo redo | insertfile | styleselect | bold italic underline | bullist | outdent indent", 
                    menubar: false
                });
                $('#btnModalPrinter').trigger('click');
            }
            
            function imprimirMPDF(){
                //Conteúdo HTML
                var html = tinymce.activeEditor.getContent();       
                
                //Form
                var form = $('<form></form>');
                form.attr('method','POST');
                form.attr('id','formTempp');
                form.attr('action','https://app.4clinics.software/agenda/imprimir_mPDF');
                form.attr('target','_blank');
            
                //Input
                var inpt = $('<input></input>');
                inpt.attr('type','hidden');
                inpt.attr('name','html');
                inpt.val(btoa(html));
            
                form.append(inpt);
            
                $('body').append(form);
            
                form.submit();
            
                setTimeout(function() {
                    if($('#formTempp').length > 0){
                        $('#formTempp').remove();
                    }
                }, 500);
            }
            
            function excluir_agendamento(){
                $('#myModalGeral2 .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Excluir Agendamento:</h4>');
                $('#myModalGeral2 .modal-body').html('<p class="centralizado"><i class="icon-warning position-right fonte_blue_logo feature-box-icon"></i> Você deseja realmente excluir este agendamento?</p>');
            
                var html = '<span class="centralizado">'+
                '<button type="button" class="btn btn-primary atendimento_btn" data-dismiss="modal" onclick="excluir_agendamento_confirma()">Confirmar Exclusão</button>'+
                '<button type="button" class="btn btn-default atendimento_btn" data-dismiss="modal">Cancelar Exclusão</button>'+
                '</spam>';
            
                $('#myModalGeral2 .modal-footer').html(html);
                $('#btnModalGeral2').trigger('click');    
            }
            
            function excluir_agendamento_confirma(){
                var dd = checkDd($("#datepicker").datepicker('getDate').getDate());
                var mm = checkMm($("#datepicker").datepicker('getDate').getMonth() + 1);
                var yyyy = $("#datepicker").datepicker('getDate').getFullYear();
            
                var id_agendas_marcacoes_ = $('#id_agendas_marcacoes_c').val();
            
                $.post('https://app.4clinics.software/agenda/excluir_agendamento',
                    {id_agendas_marcacoes: id_agendas_marcacoes_},
                    function (data) {
                        if (!data) {
                            $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Agendamento Excluído:</h4>');
                            $('#myModalGeral .modal-body').html('<p>Agendamento excluído com sucesso!</p>');
                            $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="recarregar(\''+dd+'/'+mm+'/'+yyyy+'\')">OK</button>');
                            $('#btnModalGeral').trigger('click');
                        }
                    });
            }
            
            function registrar_falta(){
                var dd = checkDd($("#datepicker").datepicker('getDate').getDate());
                var mm = checkMm($("#datepicker").datepicker('getDate').getMonth() + 1);
                var yyyy = $("#datepicker").datepicker('getDate').getFullYear();
            
                var id_agendas_marcacoes_ = $('#id_agendas_marcacoes_c').val();
            
                $.post('https://app.4clinics.software/agenda/registrar_falta',
                    {id_agendas_marcacoes: id_agendas_marcacoes_},
                    function (data) {
                        if (!data) {
                            $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Paciente Faltou:</h4>');
                            $('#myModalGeral .modal-body').html('<p>Falta registrada com sucesso!</p>');
                            $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="recarregar(\''+dd+'/'+mm+'/'+yyyy+'\')">OK</button>');
                            $('#btnModalGeral').trigger('click');
                        }
                    });
            }
            
            function enviar_cadastro(id, trid, id_benn){
                var dd = checkDd($("#datepicker").datepicker('getDate').getDate());
                var mm = checkMm($("#datepicker").datepicker('getDate').getMonth() + 1);
                var yyyy = $("#datepicker").datepicker('getDate').getFullYear();
            
                var json_ = JSON.parse($('#'+id).attr('json'));
            
                var json_par = JSON.parse(id_benn);
            
                window.location.href = 'https://app.4clinics.software/beneficiario/cadastro/'+json_par+'/id_agendas/'+json_.id_agendas+'/data_agenda/'+dd+'-'+mm+'-'+yyyy+'/'+json_.id_agendas_marcacoes;
            }
            
            function confirmar_presenca(id, trid){
                var prosseguir = verificar_dados_beneficiario_registrado(id, trid);
            
                var id_agendas_marcacoes_ = $('#id_agendas_marcacoes_c').val();
                var id_beneficiarios_ = $('#id_beneficiarios_c').val();
                var id_operadoras_ = $('#id_operadoras_c').val();
                var id_tipo_agendamento_ = $('#id_tipo_agendamento_c').val();
                var ben_nome_a = $('#agm_paciente_nome_c').val();
                var indd = ben_nome_a.indexOf('-');
                if(indd > 0){
                    var ben_nome_ = ben_nome_a.substring(0, (indd - 1));
                }else{
                    var ben_nome_ = ben_nome_a;
                }
                var ben_email_ = $('#agm_paciente_email_c').val();
                var ben_numero_carteira_ = '';
                var ben_validade_carteira_ = $('#ben_validade_carteira_c').val();
                var ben_celular_ = $('#agm_paciente_telefone_c').val();
                var ben_telefone_ = $('#agm_paciente_telefone_fixo_c').val();
                var agm_observacao_ = $('#agm_observacao_c').val();
                var primeira_consulta_ = $('#agm_primeira_consulta_c').prop('checked');
                //var agendamento_confirmado_ = $('#agm_agendamento_confirmado_c').prop('checked');
                //var agm_atendimento_particular_ = $('#agm_atendimento_particular_c').prop('checked');
                var agm_atendimento_particular_ = false;
                var id_modal = $('#hora_modal_c').val();
            
                if (id_operadoras_ == '0') {
                    agm_atendimento_particular_ = true;
                } else {
                    ben_numero_carteira_ = $('#ben_numero_carteira_c').val();
                }
            
                var dd = checkDd($("#datepicker").datepicker('getDate').getDate());
                var mm = checkMm($("#datepicker").datepicker('getDate').getMonth() + 1);
                var yyyy = $("#datepicker").datepicker('getDate').getFullYear();
                
                if ((agm_atendimento_particular_ == false) && (ben_numero_carteira_ == '')) {
                    $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Paciente na Recepção:</h4>');
                    $('#myModalGeral .modal-body').html('<p>Informe o número da carteira ou informe se o atendimento será particular para registrar a chegada do paciente!</p>');
                    $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="$(\'#'+id_modal+'\').trigger(\'click\');">OK</button>');
                    $('#btnModalGeral').trigger('click');
                }else{
                    if(! prosseguir){
                        /*-----------------------------------------------------------------------
                        | Primeiro salva o beneficiário, obtém o id dele e envia para o complemento do cadastro
                        | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                        | Em : 20/03/2016
                        |----------------------------------------------------------------------*/
                        if (agm_atendimento_particular_ == true) {
                            $.post('https://app.4clinics.software/agenda/antes_confirmar_presenca',
                            {
                                id_agendas: id_agendas,
                                id_agendas_marcacoes: id_agendas_marcacoes_,
                                id_beneficiarios: id_beneficiarios_,
                                id_operadoras: id_operadoras_,
                                id_tipo_agendamento: id_tipo_agendamento_,
                                agm_paciente_nome: ben_nome_,
                                agm_paciente_email: ben_email_,
                                agm_paciente_telefone: ben_celular_,
                                agm_paciente_telefone_fixo: ben_telefone_,
                                agm_observacao: agm_observacao_,
                                agm_primeira_consulta: primeira_consulta_
                                //agm_agendamento_confirmado: agendamento_confirmado_
                            },
                            function (data) {
                                enviar_cadastro(id, trid, data);
                            });
                        } else {
                            $.post('https://app.4clinics.software/agenda/antes_confirmar_presenca',
                            {
                                id_agendas: id_agendas,
                                id_agendas_marcacoes: id_agendas_marcacoes_,
                                id_beneficiarios: id_beneficiarios_,
                                id_operadoras: id_operadoras_,
                                id_tipo_agendamento: id_tipo_agendamento_,
                                agm_paciente_nome: ben_nome_,
                                agm_paciente_email: ben_email_,
                                ben_numero_carteira: ben_numero_carteira_,
                                ben_validade_carteira: ben_validade_carteira_,
                                agm_paciente_telefone: ben_celular_,
                                agm_paciente_telefone_fixo: ben_telefone_,
                                agm_observacao: agm_observacao_,
                                agm_primeira_consulta: primeira_consulta_
                                //agm_agendamento_confirmado: agendamento_confirmado_
                            },
                            function (data) {
                                enviar_cadastro(id, trid, data);
                            });
                        }
                    }else{
                        if (agm_atendimento_particular_ == true) {
                            $.post('https://app.4clinics.software/agenda/confirmar_presenca',
                            {
                                id_agendas: id_agendas,
                                id_agendas_marcacoes: id_agendas_marcacoes_,
                                id_beneficiarios: id_beneficiarios_,
                                id_operadoras: id_operadoras_,
                                id_tipo_agendamento: id_tipo_agendamento_,
                                agm_paciente_nome: ben_nome_,
                                agm_paciente_email: ben_email_,
                                agm_paciente_telefone: ben_celular_,
                                agm_paciente_telefone_fixo: ben_telefone_,
                                agm_observacao: agm_observacao_,
                                agm_primeira_consulta: primeira_consulta_
                                //agm_agendamento_confirmado: agendamento_confirmado_
                            },
                            function (data) {
                                if (!data) {
                                    $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Paciente na Recepção:</h4>');
                                    $('#myModalGeral .modal-body').html('<p>Registrada presença do paciente na recepção!</p>');
                                    $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="recarregar(\''+dd+'/'+mm+'/'+yyyy+'\')">OK</button>');
                                    $('#btnModalGeral').trigger('click');
                                }
                            });
                        } else {
                            $.post('https://app.4clinics.software/agenda/confirmar_presenca',
                            {
                                id_agendas: id_agendas,
                                id_agendas_marcacoes: id_agendas_marcacoes_,
                                id_beneficiarios: id_beneficiarios_,
                                id_operadoras: id_operadoras_,
                                id_tipo_agendamento: id_tipo_agendamento_,
                                agm_paciente_nome: ben_nome_,
                                agm_paciente_email: ben_email_,
                                ben_numero_carteira: ben_numero_carteira_,
                                ben_validade_carteira: ben_validade_carteira_,
                                agm_paciente_telefone: ben_celular_,
                                agm_paciente_telefone_fixo: ben_telefone_,
                                agm_observacao: agm_observacao_,
                                agm_primeira_consulta: primeira_consulta_
                                //agm_agendamento_confirmado: agendamento_confirmado_
                            },
                            function (data) {
                                if (!data) {
                                    $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Paciente na Recepção:</h4>');
                                    $('#myModalGeral .modal-body').html('<p>Registrada presença do paciente na recepção!</p>');
                                    $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="recarregar(\''+dd+'/'+mm+'/'+yyyy+'\')">OK</button>');
                                    $('#btnModalGeral').trigger('click');
                                }
                            });
                        }
                    }
                }
            }
            
            /*-----------------------------------------------------------------------
            | Para carregar os dados do dia solicitados no encaixe
            | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
            | Em : 09/06/2016
            |----------------------------------------------------------------------*/
            function obter_dados_post_temp(year, month, day, vetor_tempo, vetor_usuarios) {
                var data = year+'-'+month+'-'+day;
                $.ajax({
                    type: "POST",
                    url: 'https://app.4clinics.software/agenda/carregar_agenda_dia',
                    data: { 
                        id_agendas: id_agendas,
                        data: data
                    },
                })
                .done(function(data){
                    receber_dados_temp(data, vetor_tempo, vetor_usuarios);
                });
            }
            
            function receber_dados_temp(dados, vetor_tempo, vetor_usuarios) {
                if(dados){
                    var inserir_nome;
                    json_temp = JSON.parse(dados);
            
                    for(var i in json_temp.data_grade_horario){                
                        if((json_temp.data_grade_horario[i].agm_data_hora_marcacao.substring(11, 16) <= vetor_tempo[0]) && (json_temp.data_grade_horario[i].agm_data_hora_marcacao.substring(11, 16) >= vetor_tempo[vetor_tempo.length-1])){
                            if(vetor_usuarios.length > 0){
                                inserir_nome = false;
                                for (var ind in vetor_usuarios) {                            
                                    if(json_temp.data_grade_horario[i].agm_paciente_nome.indexOf('RESERVADO') == -1){
                                        if(vetor_usuarios[ind] === json_temp.data_grade_horario[i].agm_paciente_nome){
                                            inserir_nome = true;
                                        }
                                    }else{
                                        inserir_nome = true;
                                    }
                                }
                                if(!inserir_nome){
                                    vetor_usuarios.push(json_temp.data_grade_horario[i].agm_paciente_nome);
                                }
                            }else{
                                vetor_usuarios.push(json_temp.data_grade_horario[i].agm_paciente_nome);
                            }
                        }
                    }
            
                    if(vetor_usuarios.length > 0){
                        $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Intervalo inválido:</h4>');
                        $('#myModalGeral .modal-body').html('<p>O horário escolhido já possui estes agendamentos:</p><p>'+vetor_usuarios.toString()+'</p>');
                        $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal">OK</button>');
                        $('#btnModalGeral').trigger('click');
            
                        $('#myModalGeral').attr('style','display: block; z-index: 9999');
                    }
                }
            }
            
            $('#agm_paciente_hora_e').blur(function(a) {
                $('#errorHI').remove();
                var tempo = $(this).val();
                if((tempo != '') && (tempo != '__:__')){
                    if((parseInt(tempo.substring(0,2)) > 24) || (parseInt(tempo.substring(3)) > 59)){
                        console.log('entrou2');
                        $(this).parent().parent().find('.clearfix').eq('1').before('<label for="agm_paciente_hora_e" id="errorHI" class="error">Hora inicial inválida!</label>');
                        $(this).focus();
                    }else{
                        var tempo_atendimento = parseInt(json.data_agenda_config[0].agc_tempo_atendimento);
                        var tempo_ = new Date();
                        var tempo_f = new Date(tempo_.getFullYear(), tempo_.getMonth(), tempo_.getDate(), tempo.substring(0,2), tempo.substring(3), '00',0);
                        var tempo_intervalo = tempo_f.getMinutes()+tempo_atendimento;
                        var tempo_intervalo_r = 0;
            
            
                        /*-----------------------------------------------------------------------
                        | Se for visível, insere no campo hora final
                        | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                        | Em : 24/06/2016
                        |----------------------------------------------------------------------*/
                        if($('#hora_final_encaixe_bloco').is(':visible')){
                            var tempo_atendimento = parseInt(json.data_agenda_config[0].agc_tempo_atendimento);
                            var tempo_ = new Date();
                            var tempo_f = new Date(tempo_.getFullYear(), tempo_.getMonth(), tempo_.getDate(), tempo.substring(0,2), tempo.substring(3), '00',0);
                            var tempo_intervalo = tempo_f.getMinutes()+tempo_atendimento;
                            var tempo_intervalo_r = 0;
            
            
                            /*-----------------------------------------------------------------------
                            | Tive de fazer essa manobra, pois o setMinutes não aceita valores acima de 60
                            | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                            | Em : 25/05/2016
                            |----------------------------------------------------------------------*/
                            if(tempo_intervalo > 60){
                                tempo_intervalo_r = tempo_intervalo%60;
                                tempo_f.setMinutes(tempo_f.getMinutes()+(tempo_atendimento - tempo_intervalo_r));
                                tempo_f.setMinutes(tempo_f.getMinutes()+tempo_intervalo_r);
                            }else{
                                tempo_f.setMinutes(tempo_f.getMinutes()+tempo_atendimento);
                            }
            
                            /*-----------------------------------------------------------------------
                            | Nesse caso o checkMm não interfere no horário
                            | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                            | Em : 25/05/2016
                            |----------------------------------------------------------------------*/
                            $('#agm_paciente_hora_final_e').val(checkMm(tempo_f.getHours())+':'+checkMm(tempo_f.getMinutes()));
                        }
                    }
                }
            });
            
            /*-----------------------------------------------------------------------
            | Adicionado para informar erro ao colocar valores errados
            | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
            | Em : 24/05/2016
            |----------------------------------------------------------------------*/    
            $('#agm_paciente_hora_final_e').blur(function(a) {
                var tempo_att = json.data_agenda_config[0].agc_tempo_atendimento;
                var tempo_inicial = $('#agm_paciente_hora_e').val();
                var tempo_final = $(this).val();
                var tempo_inicial_, tempo_final_ = null;
                var temporario = null;
                var temporario1 = null;
                var vetor_tempo = [];
                vetor_usuarios = [];
                
                $('#errorHF').remove();
            
                if((tempo_final != '') && (tempo_final != '__:__')){
                    // Pegando só a parte final
                    tempo_final_ = tempo_final.substring(3);
                    tempo_inicial_ = tempo_inicial.substring(3);
                    if((tempo_final_ != '00') && ((tempo_final_%tempo_att) != (tempo_inicial_%tempo_att))){
                        $(this).parent().parent().parent().find('.clearfix').eq('1').before('<label for="agm_paciente_hora_final_e" id="errorHF" class="error">Hora final inválida, o intervalo é de '+tempo_att+' min</label>');
                        $(this).focus();
                    }else{
                        /*-----------------------------------------------------------------------
                        | Criar vetor de horas
                        | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                        | Em : 25/05/2016
                        |----------------------------------------------------------------------*/
                        temporario = new Date($("#agm_paciente_data_e").datepicker('getDate').getFullYear(), checkMm($("#agm_paciente_data_e").datepicker('getDate').getMonth() + 1), checkDd($("#agm_paciente_data_e").datepicker('getDate').getDate()), tempo_final.substring(0,2), tempo_final.substring(3), '00',0);
                        
                        while(tempo_inicial != temporario1){
                            temporario1 = checkMm(temporario.getHours())+':'+checkMm(temporario.getMinutes());
                            vetor_tempo.push(temporario1);
                            temporario.setMinutes(temporario.getMinutes() - tempo_att);
                        }
            
                        vetor_tempo.push(tempo_inicial);
            
                        obter_dados_post_temp($("#agm_paciente_data_e").datepicker('getDate').getFullYear(), checkMm($("#agm_paciente_data_e").datepicker('getDate').getMonth() + 1), checkDd($("#agm_paciente_data_e").datepicker('getDate').getDate()), vetor_tempo, vetor_usuarios);                
                    }
                }else{
                    $(this).parent().parent().find('.clearfix').eq('1').before('<label for="agm_paciente_hora_final_e" id="errorHF" class="error">Hora final inválida!</label>');
                    $(this).focus();
                }
            });
            
            function gravar_encaixe() {
                var id_beneficiarios_ = $('#id_beneficiarios_e').val();
                var data_ = $('#agm_paciente_data_e').val();
                var hora_ = $('#agm_paciente_hora_e').val();
                /*-----------------------------------------------------------------------
                | Se não for visivel, não envia hora final
                | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                | Em : 24/06/2016
                |----------------------------------------------------------------------*/
                if($('#hora_final_encaixe_bloco').is(':visible')){
                    /*-----------------------------------------------------------------------
                    | Adicionando a hora final e o tempo de atendimento
                    | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                    | Em : 24/05/2016
                    |----------------------------------------------------------------------*/
                    var horafinal_ = $('#agm_paciente_hora_final_e').val();
                }        
                var tempo_atendimento = json.data_agenda_config[0].agc_tempo_atendimento;
                //var nome_ = $('#agm_paciente_nome_e').val();
                var ben_nome_a = $('#agm_paciente_nome_e').val();
                var indd = ben_nome_a.indexOf('-');
                if(indd > 0){
                    var nome_ = ben_nome_a.substring(0, (indd - 1));
                }else{
                    var nome_ = ben_nome_a;
                }
                var email_ = $('#agm_paciente_email_e').val();
                var celular_ = $('#agm_paciente_telefone_e').val();
                var telefone_ = $('#agm_paciente_telefone_fixo_e').val();
                var id_operadoras_ = $('#id_operadoras_e').val();
                var id_tipo_agendamento_ = $('#id_tipo_agendamento_e').val();
                var observacao_ = $('#agm_observacao_e').val();
                var primeira_consulta_ = $('#agm_primeira_consulta_e').prop('checked');
            
                var dd = checkDd($("#datepicker").datepicker('getDate').getDate());
                var mm = checkMm($("#datepicker").datepicker('getDate').getMonth() + 1);
                var yyyy = $("#datepicker").datepicker('getDate').getFullYear();
            
                if(vetor_usuarios.length > 0){
                    $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Intervalo inválido:</h4>');
                    $('#myModalGeral .modal-body').html('<p>O horário escolhido já possui estes agendamentos:</p><p>'+vetor_usuarios.toString()+'</p>');
                    $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="$(\'#inserir_encaixe\').trigger(\'click\');">OK</button>');
                    $('#btnModalGeral').trigger('click');
                }else if((data_ == '') || (hora_ == '') || (horafinal_ == '') || (id_tipo_agendamento_ == '0') || (nome_ == '') || (celular_ == '') || (id_operadoras_ == '') ){
                    $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Registro de Encaixe:</h4>');
                    $('#myModalGeral .modal-body').html('<p>Para registrar um encaixe é necessário informar pelo menos, os campos: <strong>Data, Hora, Tipo do Agendamento, Nome do Paciente, Convênio/Plano de Saúde e Telefone Celular</strong>!</p>');
                    $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="$(\'#inserir_encaixe\').trigger(\'click\');">OK</button>');
                    $('#btnModalGeral').trigger('click');
                }else{
                    /*-----------------------------------------------------------------------
                    | Se não for visivel, não envia hora final
                    | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                    | Em : 24/06/2016
                    |----------------------------------------------------------------------*/
                    if($('#hora_final_encaixe_bloco').is(':visible')){
                        $.post('https://app.4clinics.software/agenda/gravar_encaixe',
                            {id_agendas: id_agendas,
                                id_beneficiarios: id_beneficiarios_,
                                agm_data: data_,
                                agm_hora: hora_,
                                agm_hora_final: horafinal_,
                                agm_tempo_consulta: tempo_atendimento,
                                id_tipo_agendamento: id_tipo_agendamento_,
                                agm_paciente_nome: nome_,
                                agm_paciente_telefone: celular_,
                                agm_paciente_telefone_fixo: telefone_,
                                agm_paciente_email: email_,                
                                id_operadoras: id_operadoras_,
                                agm_observacao: observacao_,
                                agm_primeira_consulta: primeira_consulta_
                            },
                        function (data) {
                            if (!data) {
                                $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Registro de Encaixe:</h4>');
                                $('#myModalGeral .modal-body').html('<p>Encaixe registrado com sucesso!</p>');
                                $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="recarregar(\''+dd+'/'+mm+'/'+yyyy+'\')">OK</button>');
                                $('#btnModalGeral').trigger('click');
                            }else{
                                $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Registro de Encaixe:</h4>');
                                $('#myModalGeral .modal-body').html('<p>Existem outros agendamentos no horário/intervalo de horários, necessário para o agendamento.</p><p>A operação não será executada. Favor selecione outro horário inicial</p>');
                                $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="recarregar(\''+dd+'/'+mm+'/'+yyyy+'\')">OK</button>');
                                $('#btnModalGeral').trigger('click');                    
                            }
                        });
                    }else{
                        $.post('https://app.4clinics.software/agenda/gravar_encaixe',
                            {id_agendas: id_agendas,
                                id_beneficiarios: id_beneficiarios_,
                                agm_data: data_,
                                agm_hora: hora_,
                                agm_tempo_consulta: tempo_atendimento,
                                id_tipo_agendamento: id_tipo_agendamento_,
                                agm_paciente_nome: nome_,
                                agm_paciente_telefone: celular_,
                                agm_paciente_telefone_fixo: telefone_,
                                agm_paciente_email: email_,                
                                id_operadoras: id_operadoras_,
                                agm_observacao: observacao_,
                                agm_primeira_consulta: primeira_consulta_
                            },
                        function (data) {
                            if (!data) {
                                $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Registro de Encaixe:</h4>');
                                $('#myModalGeral .modal-body').html('<p>Encaixe registrado com sucesso!</p>');
                                $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="recarregar(\''+dd+'/'+mm+'/'+yyyy+'\')">OK</button>');
                                $('#btnModalGeral').trigger('click');
                            }else{
                                $('#myModalGeral .modal-header').html('<button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title modal-title-darkblue">Registro de Encaixe:</h4>');
                                $('#myModalGeral .modal-body').html('<p>Existem outros agendamentos no horário/intervalo de horários, necessário para o agendamento.</p><p>A operação não será executada. Favor selecione outro horário inicial</p>');
                                $('#myModalGeral .modal-footer').html('<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="recarregar(\''+dd+'/'+mm+'/'+yyyy+'\')">OK</button>');
                                $('#btnModalGeral').trigger('click');                    
                            }
                        });
                    }
                }
            }
            
            
            function mostraCamposConvenio() {
                var id_operadoras = $('#id_operadoras_c').val();
                var id_operadoras_cadastrado = $('#id_operadoras_cadastrado').val();
                if (id_operadoras != '0') {
                    if (id_operadoras != id_operadoras_cadastrado) {
                        $('#ben_numero_carteira_c').val('');
                        $('#ben_validade_carteira_c').val('');
                    }
                    document.getElementById("atendimento_convenio").style.visibility = "";
                    document.getElementById('atendimento_convenio').style.display = "";
                } else {
                    document.getElementById("atendimento_convenio").style.visibility = "hidden";
                    document.getElementById('atendimento_convenio').style.display = "none";
                }
            }
            
            function abrirProntuario(id, trid){
                var prosseguir = verificar_dados_beneficiario_registrado(id, trid);
            var json_ = JSON.parse($('#'+id).attr('json'));
            
                if (prosseguir) {
                    dd_ = $("#datepicker").datepicker('getDate').getDate();
                    mm_ = $("#datepicker").datepicker('getDate').getMonth() + 1; //Janeiro é 0!
                    yyyy_ = $("#datepicker").datepicker('getDate').getFullYear();
                    data_ = yyyy_+'-'+checkMm(mm_)+'-'+checkDd(dd_);
                    window.location.href = 'https://app.4clinics.software/prontuario/atendimento/'+json_.id_beneficiarios+'/'+json_.id_agendas_marcacoes+'/'+id_agendas+'/'+json_.id_atendimentos+'/'+data_;
                    //alert("erro atender: " + nome);
                } else {
                    window.location.href = 'https://app.4clinics.software/beneficiario/cadastro/'+json_.id_beneficiarios+'/'+json_.id_agendas_marcacoes;
                    //alert("erro cadastro: " + nome);
                }
            }
            
            function verificar_dados_beneficiario_registrado(id, trid){
                //alert("acessou abrir: ");
                var json_ = JSON.parse($('#'+id).attr('json'));
                var nome = json_.agm_paciente_nome;
                var nascimento = json_.ben_data_nascimento;
                var estado_civil = json_.descricao_estado_civil;
                var sexo = json_.descricao_sexo;
                var telefone = json_.ben_telefone;
                var prosseguir = true;
                
            
                if ((nome == '') || (nome == 'null') || (nome == null)) {
                    prosseguir = false;
                    //alert("erro nome: " + nome);
                }
            
                if ((estado_civil == '') || (estado_civil == 'null') || (estado_civil == null)) {
                    prosseguir = false;
                    //alert("erro estado civil: " + estado_civil);
                }
                
                if ((sexo == '') || (sexo == 'null') || (sexo == null)) {
                    prosseguir = false;
                    //alert("erro sexo: " + sexo);
                }
            
                /*-----------------------------------------------------------------------
                | Adicionado o telefone, o mesmo não existia
                | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
                | Em : 23/05/2016
                |----------------------------------------------------------------------*/
            
                if ((nascimento == '') || (nascimento == 'null') || (nascimento == null)) {
                    prosseguir = false;
                    //alert("erro nascimento: " + nascimento);
                } else if (nascimento.substring(0,2) == '00') {
                    prosseguir = false;
                }
            
                return prosseguir;
            }
            
            setTimeout(function(){
            $('#lcm_valor').maskMoney({showSymbol:false, symbol:"R$", decimal:",", thousands:"."});
            },50);
            
            function validatePessoa() {
            $('.error[for="ben_cpf"]').remove();
            var cpf = $('#ben_cpf').val().replace(/[^0-9]+/g, '');
            var field_name = 'CPF';
            var msg = '';
            var id_beneficiarios = $('#id_beneficiarios_fat').val();
            
            if (cpf) {
            $('.error[for="ben_cpf"]').remove();
            if (!isCPF(cpf)) {
            msg = 'Por favor informe um "CPF" válido.';
            msg = '<label class="error manual" for="ben_cpf">' + msg + '</label>';
            $('#ben_cpf').after(msg);
            $('#ben_cpf').val('');
            document.getElementById("ben_cpf").focus();
            }
            checkDuplicateData('ben_cpf', $('#ben_cpf').val(), field_name, id_beneficiarios);
            }
            }
            
            function isCPF(num) {
            var i, j, k, soma, digito, iguais;
            if (num.length != 11) {
            return false;
            }
            
            iguais = true;
            for (i = 1; i < num.length; i++) {
            if (num.charAt(i - 1) != num.charAt(i) && iguais) {
            iguais = false;
            }
            }
            if (iguais) {
            return false;
            }
            
            for (j = 10; j <= 11; j++) {
            soma = 0;
            for (i = 0, k = j; i < j - 1; i++, k--) {
            soma += eval(num.charAt(i)) * k;
            }
            
            digito = 11 - (soma % 11);
            if (digito > 9) {
            digito = 0;
            }
            
            if (eval(num.charAt(j - 1)) != eval(digito)) {
            return false;
            }
            }
            
            return true;
            }
            
            function checkDuplicateData(field, data_field, field_name, id_beneficiarios) {      
            $.post(
            HTTPS_ROOT + 'int_beneficiario/checkDuplicateData',
            {field: field, data_field: data_field, id_beneficiarios: id_beneficiarios},
            function (res) {    
            if (res == 'true') {    
            $('.error[for="' + field + '"]').remove();
            msg = 'O "' + field_name + '" informado já esta em uso.';
            msg = '<label class="error manual" for="' + field + '">' + msg + '</label>';
            $('#' + field).after(msg);
            $('#' + field).val('');
            document.getElementById("ben_cpf").focus();
            }
            });
            }
            
            $("#desc_tuss_procedimento").select2({
            locale: 'pt',
            placeholder: "Buscar...",
            minimumInputLength: 5,
            ajax: {
            url: "https://app.4clinics.software/cadastro/buscar_procedimento",
            dataType: 'json',
            quietMillis: 250,
            width: 400,
            data: function (term, page) {
            return {
                q: term,
            }
            },
            results: function (data, page) {
            return {results: data.items}
            },
            cache: false
            },
            initSelection: function (element, callback) {
            var id = $(element).val();
            if (id !== "") {
            $.ajax("https://app.4clinics.software/cadastro/buscar_procedimento/?value=" + id, {
                dataType: "json"
            }).done(function (data) {
                callback(data);
            })
            }
            },
            formatResult: repoFormatResult4,
            formatSelection: repoFormatSelection4,
            dropdownCssClass: "bigdrop",
            escapeMarkup: function (m) {
            return m
            }
            }); 
            
            function repoFormatResult4(repo) {
                var markup = '<div class="row">' +
                        '<div class="col-xs-12">' +
                        '<div class="row">' +
                        '<div class="col-xs-12">' + repo.resultado + '</div>' +
                        '</div>';
                markup += '</div></div>';
            
                return markup;
            }
            
            function repoFormatSelection4(repo) {
                $('#id_tuss_procedimento').val(repo.id);
                return repo.resultado;
            }
            
            /*-----------------------------------------------------------------------
            | Para recarregar após fechar o modal de impressão
            | Por: Richardson S. Westphal     <rsw.empresa@gmail.com>
            | Em : 30/06/2016
            |----------------------------------------------------------------------*/
            $('#myModalPrinter').on('hidden.bs.modal', function () {
                window.location.href = window.location.href;
            });
            
        </script>
        <script type="text/javascript" src="https://app.4clinics.software/skin/home/app_theme/js/datatables/jquery.dataTables.min.js"></script>
        <script type="text/javascript" src="https://app.4clinics.software/skin/home/app_theme/js/datatables/dataTables.bootstrap.js"></script>
        <script type="text/javascript" src="https://app.4clinics.software/skin/home/app_theme/js/datatables/datatables-helper.js"></script>
    </div>
</div>
