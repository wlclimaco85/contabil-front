<script src="thirdparty/aaPrincipal/js/kendo.all.min.js"></script>
<script src="thirdparty/aaPrincipal/js/jquery.bootstrap.wizard.min.js"></script>
<div style="margin-top : 100px" id="wizard" style="background-color : #000000" ng-controller="NewEmpresaUpdateController">
    <div class='container'>
        <div id="rootwizard" class="agilContabil" style="width: 78%;">
            <div class="navbar">
                <div class="navbar-inner">
                    <div class="container">
                        <ul>
                            <li><a href=".tab2" data-toggle="tab">Informações da Empresa</a></li>
                            <li><a href=".tab3" data-toggle="tab">Informações de Socios</a></li>
                            <li><a href=".tab4" data-toggle="tab">Usuarios</a></li>
                            <li><a href=".tab5" data-toggle="tab">Contrato Social</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div id="bar" class="progress">
                <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;background : red"></div>
            </div>
            <form ng-submit="submit()" class="empresaForm">
                <div class="tab-content">
                    <div class="tab-pane tab2" id="tab2">
                        <div class="panel-body">

                            <div class="row">
                                <div class="col-sm-6">
                                    <label for="exampleInputPassword1">Sua Empresa Esta Ativa?</label>
                                    <dl class="dl-horizontal">
                                        <dd>
                                            <label class="ui-radio"><input name="statusEmpresa" ng-model="empresa.statusInicial" type="radio" value="1" ng-true-value="'1'" ng-init="empresa.statusInicial=1" ><span>Sim</span></label>
                                            <label class="ui-radio"><input name="statusEmpresa" ng-model="empresa.statusInicial" type="radio" value="2" ng-true-value="'2'"><span data-i18n="Nao"></span></label>
                                        </dd>
                                    </dl>
                                </div>
                                <div class="col-sm-6">
                                    <label for="exampleInputPassword1">Selecione o regime Tributario da Empresa</label>
                                    <dl class="dl-horizontal">
                                        <dd>
                                            <label class="ui-radio"><input name="regime" type="radio" ng-model="empresa.regime.id" value="4" ng-true-value="'4'" ng-init="empresa.regime.id=4" ><span>MEI</span></label>
                                            <label class="ui-radio"><input name="regime" type="radio" ng-model="empresa.regime.id" value="1" ng-true-value="'1'" ng-init="empresa.regime.id=1" ><span>Simples Nacional</span></label>
                                            <label class="ui-radio"><input name="regime" type="radio" ng-model="empresa.regime.id" value="2" ng-true-value="'2'"><span>Lucro Real</span></label>
                                            <label class="ui-radio"><input name="regime" type="radio" ng-model="empresa.regime.id" value="3" ng-true-value="'3'"><span>Lucro Presumido</span></label>
                                        </dd>
                                    </dl>

                                </div>
                            </div>
                            <div class="row">
                                <label for="exampleInputPassword1">Selecione o Tipo Pessoa</label>
                                <dl class="dl-horizontal">
                                    <dd>
                                        <label class="ui-radio"><input name="radio5" type="radio"  ng-model="empresa.tipoPessoa" ng-init="empresa.tipoPessoa=1" value="1" ng-true-value="'1'" ><span>Pessoa Fisica </span></label>
                                        <label class="ui-radio"><input name="radio6" type="radio" ng-model="empresa.tipoPessoa" value="2" ng-true-value="'2'"><span>Pessoa Juridica </span></label>
                                    </dd>
                                </dl>
                            </div>
                            <div class="row">
                                <div class="form-group col-sm-12">
                                    <label for="exampleInputEmail1" ng-show="empresa.tipoPessoa == 1" ng-hide="empresa.tipoPessoa == 2">Nome</label>
                                    <label for="exampleInputEmail1" ng-show="empresa.tipoPessoa == 2" ng-hide="empresa.tipoPessoa == 1"><span data-i18n="Razao social"></span></label>
                                    <input type="text" ng-model="empresa.razao" name="razao" class="form-control" placeholder="Razão Social">
                                </div>
                            </div>

                            <div ng-show="empresa.tipoPessoa == 1" ng-hide="empresa.tipoPessoa == 2" ng-include="'views/util/apps/documentosFisico.html'"></div>

                            <!-- telefone -->
                            <div ng-show="empresa.tipoPessoa == 2" ng-hide="empresa.tipoPessoa == 1" ng-include="'views/util/apps/documentosJuridicos.html'"></div>


                            <div class="row">
                                <div class="form-group col-sm-3">
                                    <label for="exampleInputEmail1">Nº Inscr. Junta Comercial</label>
                                    <div class="input-group">
                                        <span class="InputSign input-group-addon" target="contatos_cpfcnpj"><span title="Apenas números" class="fa fa-credit-card"></span></span>
                                        <input type="text" ng-model="documento.numero" name="cpf" class="form-control" ui-mask="999.999.999-99" ui-mask-placeholder ui-mask-placeholder-char="_">
                                        <input type="text" ng-model="documento.documentoTypeEnumValue" name="cnpjs" value="4" class="form-control hide" placeholder="Nº Cart. Trab" ng-init="documento.documentoTypeEnumValue=2">
                                    </div>
                                </div>
                                <div class="form-group col-sm-3">
                                    <label for="exampleInputEmail1">CPF do responsável</label>
                                    <input type="text" class="form-control col-sm-3" ng-model="empresa.cpfResponsavel" name="responsavel" placeholder="CPF do responsável">
                                </div>
                                <div class="form-group col-sm-6">
                                    <label for="exampleInputEmail1">Nome do responsável</label>
                                    <input type="text" class="form-control col-sm-3" ng-model="empresa.responsavel" name="responsavel" placeholder="Nome do responsável">
                                </div>

                            </div>
                            <div ng-controller="EnderecoControllers as endereco">
                                <div ng-include="'views/util/apps/endereco.html'"></div>
                            </div>
                            <!-- telefone -->
                            <div ng-include="'views/util/apps/telefone.html'"></div>

                            <!-- email -->
                            <div ng-include="'views/util/apps/email.html'"></div>


                            <!-- Cnae -->
                            <div ng-include="'views/fiscal/apps/cnae.html'"></div>


                        </div>
                    </div>
                    <div class="tab-pane tab3" id="tab3">
                        <div ng-repeat="socio in empresa.socios">
                            <div class="row socios">
                                <div class="col-sm-2">
                                    <div class="form-group">
                                        <label for="exampleInputPassword1">CPF Socio</label>
                                        <input type="text" ng-model="socio.pessoa.documentos[0].numero" class="form-control cpf-socio" name="book[0].cpf" placeholder="CPF Socio" />
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label for="exampleInputPassword1">Nome Socio</label>
                                        <input type="text" ng-model="socio.pessoa.nome" class="form-control nome-socio" name="book[0].nome" placeholder="Nome Socio" />
                                    </div>
                                </div>
                                <div class="col-sm-2">
                                    <div class="form-group">
                                        <label for="exampleInputPassword1">Porcentagem</label>
                                        <input type="text" ng-model="socio.porcentagem" class="form-control cota-socio" name="book[0].cota" placeholder="%" />
                                    </div>
                                </div>
                                <div class="col-sm-3" style="margin-top:18px">
                                    <div class="checkbox">
                                        <toggle ng-model="socio.socioAdm" ng-init="socio.socioAdm = false" style="android" on="A Receber" off="Recebido" onstyle="btn-default" offstyle="btn-info" ng-true-value="'2'" ng-false-value="'1'"></toggle>
                                    </div>
                                </div>
                                <div class="col-xs-1" style="margin-top:18px">
                                    <button type="button" class="btn btn-default addButton"><i class="fa fa-plus"></i></button>
                                </div>
                                <div class="col-xs-1" style="margin-top:18px">
                                    <button type="button" class="btn btn-default removeButton"><i class="fa fa-minus"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane tab4" id="tab4">
                        <div class="panel panel-default" style="background:#EEEEEE">
                            <div class="panel-heading" style="background: #DDDDDD">
                                <div class="row">
                                    <div class="col-sm-2">CPF</div>
                                    <div class="col-sm-2">Nome</div>
                                    <div class="col-sm-3">Login(Email)</div>
                                    <div class="col-sm-2">Senha</div>
                                    <div class="col-sm-2">Permissões</div>
                                    <div class="col-sm-1"></div>
                                </div>
                            </div>

                            <div class="panel-body">
                                <div class="col-sm-12">
                                    <div class="row">
                                        <div class="col-sm-11"></div>
                                        <div class="col-sm-1">
                                            <button type="button" ng-click="createForm3()" class="btn btn-default addButton"><i class="fa fa-plus"></i></button>
                                        </div>
                                    </div>
                                    <div ng-repeat="usuario in empresa.usuarios">

                                        <div class="col-sm-2">
                                            <input type="text" ng-model="usuario.cpf" name="cpf" class="form-control" placeholder="CPF">
                                        </div>
                                        <div class="col-sm-2">
                                            <input type="text" ng-model="usuario.nome" name="nome" class="form-control" placeholder="Nome">
                                        </div>
                                        <div class="col-sm-3">
                                            <input type="text" ng-model="usuario.email" name="email" class="form-control" placeholder="Login(Email)">
                                        </div>
                                        <div class="col-sm-2">
                                            <input type="text" ng-model="usuario.senha" name="senha" class="form-control" placeholder="Senha">
                                        </div>
                                        <div class="col-sm-2">
                                            <ui-select multiple ng-model="multipleDemo" theme="bootstrap" close-on-select="true" title="Choose a color">
                                                <ui-select-match placeholder="...">{{$item}}</ui-select-match>
                                                <ui-select-choices repeat="color in availableColors | filter:$select.search">
                                                    {{color}}
                                                </ui-select-choices>
                                            </ui-select>
                                        </div>
                                        <div class="col-sm-1">
                                            <button type="button" ng-click="createForm3()" class="btn btn-default addButton"><i class="fa fa-minus"></i></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane tab5" id="tab5" style="height:500px;">
                        <div id="Layer1" style="overflow:auto;height:400px;left:10px; top:20px;">
                            <div ng-include="'views/empresa/apps/contrato.html'"></div>

                        </div>
                        <div>
                            <button class="btn btn-primary" ng-click="cc.generatePDF()"><i class="fa fa-save"></i> Save as PDF</button>
                        </div>

                    </div>
                    <ul class="pager wizard">
                        <li class="previous first" style="display:none;"><a href="javascript:;">Primeira</a></li>
                        <li class="previous"><a href="javascript:;">Anterior</a></li>
                        <li class="next last" style="display:none;"><a href="javascript:;">Ultima</a></li>
                        <li class="next"><a href="javascript:;">Proximo</a></li>
                        <li class="hide save-empresa"><input type="submit" id="submit" value="Submit" ng-click="saveEmpresa()" /></li>
                    </ul>
                </div>
            </form>



        </div>

    </div>

</div>

<style>
    /*
            Use the DejaVu Sans font for display and embedding in the PDF file.
            The standard PDF fonts have no support for Unicode characters.
        */

    .pdf-page {
        font-family: "DejaVu Sans", "Arial", sans-serif;
    }

</style>
<!---->
<script>
    // Import DejaVu Sans font for embedding

    // NOTE: Only required if the Kendo UI stylesheets are loaded
    // from a different origin, e.g. cdn.kendostatic.com
    kendo.pdf.defineFont({
        "DejaVu Sans": "//kendo.cdn.telerik.com/2016.2.607/styles/fonts/DejaVu/DejaVuSans.ttf",
        "DejaVu Sans|Bold": "//kendo.cdn.telerik.com/2016.2.607/styles/fonts/DejaVu/DejaVuSans-Bold.ttf",
        "DejaVu Sans|Bold|Italic": "//kendo.cdn.telerik.com/2016.2.607/styles/fonts/DejaVu/DejaVuSans-Oblique.ttf",
        "DejaVu Sans|Italic": "//kendo.cdn.telerik.com/2016.2.607/styles/fonts/DejaVu/DejaVuSans-Oblique.ttf"
    });



    $('#file-fr').fileinput({
        language: 'fr',
        uploadUrl: '#',
        allowedFileExtensions: ['jpg', 'png', 'gif'],
    });
    $('#file-es').fileinput({
        language: 'es',
        uploadUrl: '#',
        allowedFileExtensions: ['jpg', 'png', 'gif'],
    });
    $("#file-0").fileinput({
        'allowedFileExtensions': ['jpg', 'png', 'gif'],
    });
    $("#file-1").fileinput({
        uploadUrl: '#', // you must set a valid URL here else you will get an error
        allowedFileExtensions: ['jpg', 'png', 'gif'],
        overwriteInitial: false,
        maxFileSize: 1000,
        maxFilesNum: 10,
        //allowedFileTypes: ['image', 'video', 'flash'],
        slugCallback: function(filename) {
            return filename.replace('(', '_').replace(']', '_');
        }
    });
    /*
    $(".file").on('fileselect', function(event, n, l) {
        alert('File Selected. Name: ' + l + ', Num: ' + n);
    });
    */
    $("#file-3").fileinput({
        showUpload: false,
        showCaption: false,
        browseClass: "btn btn-primary btn-lg",
        fileType: "any",
        previewFileIcon: "<i class='glyphicon glyphicon-king'></i>"
    });
    $("#file-4").fileinput({
        uploadExtraData: {
            kvId: '10'
        }
    });
    $(".btn-warning").on('click', function() {
        if ($('#file-4').attr('disabled')) {
            $('#file-4').fileinput('enable');
        } else {
            $('#file-4').fileinput('disable');
        }
    });
    $(".btn-info").on('click', function() {
        $('#file-4').fileinput('refresh', {
            previewClass: 'bg-info'
        });
    });
    /*
    $('#file-4').on('fileselectnone', function() {
        alert('Huh! You selected no files.');
    });
    $('#file-4').on('filebrowse', function() {
        alert('File browse clicked for #file-4');
    });
    */
    $(document).ready(function() {





        $("#test-upload").fileinput({
            'showPreview': false,
            'allowedFileExtensions': ['jpg', 'png', 'gif'],
            'elErrorContainer': '#errorBlock'
        });

        bookIndex = 0;

        $('.empresaForm')
            .formValidation({
                framework: 'bootstrap',
                icon: {
                    valid: 'glyphicon glyphicon-ok',
                    invalid: 'glyphicon glyphicon-remove',
                    validating: 'glyphicon glyphicon-refresh'
                },
                fields: {

                    'book[0].cpfs': notEmptyStringMinMaxRegexp,
                    'book[0].nomes': notEmptyStringMinMax,
                    'book[0].cotas': integerNotEmptyValidation,
                    nomes: notEmptyStringMinMax,
                    nunFuncs: integerNotEmptyValidation,
                    razaos: notEmptyStringMinMax,
                    logradouros: notEmptyStringMinMax,
                    cpfs: notEmptyStringMinMaxRegexp,
                    ceps: notEmptyStringMinMax,
                    cnpjs: notEmptyStringMinMax,
                    emails: emailValidation,
                    telefones: telefoneValidation,
                    phones: telefoneValidation,
                    ceps: cepNotEmptyValidation,
                    password: {
                        validators: {
                            notEmpty: {
                                message: 'The password is required and can\'t be empty'
                            }
                        }
                    },
                    confirmPassword: {
                        validators: {
                            notEmpty: {
                                message: 'The confirm password is required and can\'t be empty'
                            },
                            identical: {
                                field: 'password',
                                message: 'The password and its confirm are not the same'
                            }
                        }
                    }

                }
            })

        $("select").select2({
            placeholder: "Select a state",
            allowClear: true
        });

        $('#rootwizard').bootstrapWizard({
            onNext: function(tab, navigation, index) {
                /*  if(index==2) {
                        // Make sure we entered the name
                        if(!$('#name').val()) {
                            alert('You must enter your name');
                            $('#name').focus();
                            return false;
                        }
                    }

                    // Set the name for the next tab
                    $('#tab3').html('Hello, ' + $('#name').val());
                */
            },
            onTabShow: function(tab, navigation, index) {

                var $total = navigation.find('li').length;
                var $current = index + 1;
                var $percent = ($current / $total) * 100;
                $('#rootwizard .progress-bar').css({
                    width: $percent + '%'
                });
                if ($percent == 100) {
                    $('.save-empresa').removeClass('hide');
                } else {
                    $('.save-empresa').addClass('hide');
                }
            },
            onNext: function(tab, navigation, index) {
                var numTabs = $('.empresaForm').find('.tab-pane').length,
                    isValidTab = validateTab(index - 1);
                if (!isValidTab) {
                    return false;
                }

                if (index === numTabs) {
                    alert('agora');
                    // We are at the last tab

                    // Uncomment the following line to submit the form using the defaultSubmit() method
                    // $('#installationForm').formValidation('defaultSubmit');

                    // For testing purpose
                    $('#completeModal').modal();
                }

                return true;
            }
        });

        window.prettyPrint && prettyPrint();


        //============================= Email fim
        function validateTab(index) {
            var fv = $('.empresaForm').data('formValidation'), // FormValidation instance
                // The current tab
                $tab = $('.empresaForm').find('.tab-pane').eq(index);

            // Validate the container
            fv.validateContainer($tab);

            var isValidStep = fv.isValidContainer($tab);
            if (isValidStep === false || isValidStep === null) {
                // Do not jump to the target tab
                return false;
            }

            return true;
        }

        /*
        //Tab 1
        $('.empresaForm').find('[name="nome"]').val('099.099.099.099');
        $('.empresaForm').find('[name="cpf"]').val('099.099.099.099');
        $('.empresaForm').find('[name="telefone"]').val('34988406670');
        $('.empresaForm').find('[name="email"]').val('wlclimaco@gmail.com');
        $('.empresaForm').find('[name="password"]').val('099.099.099.099');
        $('.empresaForm').find('[name="confirmPassword"]').val('099.099.099.099');

        //Tab 2
        $('.empresaForm').find('[name="cnpj"]').val('099.099.099.099');
        $('.empresaForm').find('[name="numfunc"]').val('8');
        $('.empresaForm').find('[name="razao"]').val('34988406670');
        $('.empresaForm').find('[name="cep"]').val('38082243');
        $('.empresaForm').find('[name="numero"]').val('686');
        $('.empresaForm').find('[name="complemento"]').val('complemento');
        $('.empresaForm').find('[name="logradouro"]').val('logradouro');
        $('.empresaForm').find('[name="book[0].nome"]').val('joao das coves');
        $('.empresaForm').find('[name="book[0].cpf"]').val('05790167659');
        $('.empresaForm').find('[name="book[0].cpf"]').val('10');
        */
    });
    //prencher form
    /*
    //Tab 1
    $('.empresaForm').find('[name="nome"]').val('099.099.099.099');
    $('.empresaForm').find('[name="cpf"]').val('099.099.099.099');
    $('.empresaForm').find('[name="telefone"]').val('34988406670');
    $('.empresaForm').find('[name="email"]').val('wlclimaco@gmail.com');
    $('.empresaForm').find('[name="password"]').val('099.099.099.099');
    $('.empresaForm').find('[name="confirmPassword"]').val('099.099.099.099');

    //Tab 2
    $('.empresaForm').find('[name="cnpj"]').val('099.099.099.099');
    $('.empresaForm').find('[name="nunfunc"]').val('8');
    $('.empresaForm').find('[name="razao"]').val('34988406670');
    $('.empresaForm').find('[name="cep"]').val('38082243');
    $('.empresaForm').find('[name="numero"]').val('686');
    $('.empresaForm').find('[name="complemento"]').val('complemento');



    //Tab 3
    $('.empresaForm').find('[name="nome"]').val('099.099.099.099');
    $('.empresaForm').find('[name="cpf"]').val('099.099.099.099');
    $('.empresaForm').find('[name="telefone"]').val('34988406670');
    $('.empresaForm').find('[name="email"]').val('wlclimaco@gmail.com');
    $('.empresaForm').find('[name="password"]').val('099.099.099.099');
    $('.empresaForm').find('[name="confirmPassword"]').val('099.099.099.099');
    */

</script>

